use blasrs::level3::complex;
use num_complex::Complex;
mod fixtures;
mod utils;

#[test]
fn gemm() {
    let a = fixtures::complex::matrix_mxn(8, 8);
    let b = fixtures::complex::matrix_mxn(8, 8);
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.5385460832679660, 5.0690152586597081),
            Complex::new(-2.6668156566873562, -0.95327875381959548),
            Complex::new(1.0864434009347868, 1.0136790833257363),
            Complex::new(0.21529965576385168, 1.0362530742021119),
            Complex::new(-0.44427875558086150, 3.8893757281660841),
            Complex::new(-1.3168380465089167, 1.6912889485612981E-002),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-0.22029981738555621, -3.6602270424583390),
            Complex::new(-0.47069741916643004, -0.58158753995566848),
            Complex::new(-1.3679335994458062, -2.6081595934017354),
            Complex::new(1.1465666351200188, 1.2858744788142780),
            Complex::new(1.8894501128227057, -1.9940821292770452),
            Complex::new(0.43706750850075698, 0.33320764722151042),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.73606199358718538, 4.1422107995963628),
            Complex::new(-1.8830774925819000, 0.67501876995862875),
            Complex::new(2.4847238931676285, 5.9317114443042307),
            Complex::new(2.4017289164433526, -2.1996136400808823),
            Complex::new(1.0456348921765743, 1.2631338026755818),
            Complex::new(-2.7779172314869109, 0.34707730027773437),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.7507023746572674, -0.92482442453045466),
            Complex::new(-0.61028031926425275, 0.66709053352315140),
            Complex::new(0.55808061956403332, 0.99345423648981535),
            Complex::new(1.5141289683700438, 0.92641488051832510),
            Complex::new(1.8194357932749106, -0.50414758869762144),
            Complex::new(-1.1776431086703421, -0.32461855858811939),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(1.4671025670411000, 1.0634086078069738),
            Complex::new(-0.23722790624927370, 0.54215298521788269),
            Complex::new(0.30637324007597794, 0.21934840409289302),
            Complex::new(-0.85165835536951418, 2.0133777907800230),
            Complex::new(-2.6918384958555888, 1.3759187103651978),
            Complex::new(0.24831136112101759, -1.2059451520265783),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(0.71527292351378835, -0.13092251889185963),
            Complex::new(-1.9886168556329511, -9.0496435520083407E-002),
            Complex::new(0.70777425077490119, 0.78880767481837477),
            Complex::new(3.8510307852580397, -3.2624509575940293),
            Complex::new(4.9506530056845701, -0.48952525208937792),
            Complex::new(-3.1375194965446105, 2.3072607976361610),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(2.0044098154271035, -1.5061363774597527),
            Complex::new(-0.90988069611254252, 1.1872004143335997),
            Complex::new(0.23488258223005987, -0.86992720354388609),
            Complex::new(-5.4018024559250144E-002, -1.5203825935717596),
            Complex::new(2.7658924922837782, 0.46603099946366050),
            Complex::new(1.8724129048158211, 0.17016973619026576),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(-3.3503023073547413, -1.3992004448402335),
            Complex::new(2.0863988846205275, 2.1939036826201685E-002),
            Complex::new(1.7300381599470136, -0.75898692502036536),
            Complex::new(-1.1258130130494317, -4.3543825441957367),
            Complex::new(0.39262150761730241, -2.2824825611908137),
            Complex::new(-0.38190745970863260, 1.5606792346498484),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(4.0796835482254643, 3.8602197766084028),
            Complex::new(-2.9451794668445928, -0.60638944353579594),
            Complex::new(1.8111268633859385, -0.29782119943125152),
            Complex::new(-0.26266325056641937, 7.4178839685577369E-002),
            Complex::new(0.87911545540435498, 3.2060819462404391),
            Complex::new(-0.56025117362448107, 1.1367237019560907),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-1.1524028321356348, -3.4222991919298629),
            Complex::new(-1.8041005972235515, -2.2921920900580890),
            Complex::new(-2.7716779841480168, -2.9062779268922014),
            Complex::new(2.2315981487667327, 1.6937744845109919),
            Complex::new(2.7846192173864353, -1.2423659096176540),
            Complex::new(0.31309687290825711, 0.61024265525018151),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(2.6387089509644839, 3.4521591144709562),
            Complex::new(-2.3409645648155628, 1.5476234868646503),
            Complex::new(2.3536852492853741, 5.5941402862293277),
            Complex::new(2.8493496725869933, -1.2596111250628588),
            Complex::new(1.5850830988910882, 1.3188994561631100),
            Complex::new(-2.9914951667888392, 7.9685468590763420E-002),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(2.0491068424844152, -0.95088478260864173),
            Complex::new(-0.71983830119578984, 0.26641323252343119),
            Complex::new(-0.41159259930722059, 0.31296852478881410),
            Complex::new(1.5596594789972318, 1.5023430347473723),
            Complex::new(1.4243806840861288, 0.68652561343962792),
            Complex::new(-0.99317755529030627, -0.41045219281315459),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(1.7524947603196539, 1.3603743454026176),
            Complex::new(-5.5103032519852935E-002, 1.0486726695105522),
            Complex::new(0.17634820448567151, -0.36588346796251636),
            Complex::new(-0.87617000295919245, 1.0403807128828759),
            Complex::new(-1.8799071716726714, 0.32959954384914492),
            Complex::new(7.3227292121070514E-002, -0.79708799704840494),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(0.69540545533749099, -1.6201733083144130),
            Complex::new(-3.3327261009348716, -0.23110329396141921),
            Complex::new(5.5477393949894427E-002, 1.3367482709807623),
            Complex::new(3.7816630893696441, -2.5378722264657729),
            Complex::new(5.1793533798065399, 0.44488463176232718),
            Complex::new(-1.0006786920744175, 2.6788026370501292),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(0.91987474887412068, -1.9422426604703886),
            Complex::new(-1.0959842276237231, 1.4269556848110623),
            Complex::new(-5.7716980960274555E-002, -1.0229940734147107),
            Complex::new(-0.30788614329045261, -1.1367182421134434),
            Complex::new(2.4793983521580545, -1.5375053441635589),
            Complex::new(1.3179438356557611, 0.98482525494044926),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(-3.6533652753564492, -1.8489414961824382),
            Complex::new(2.4228401174275858, 8.4558706004623008E-002),
            Complex::new(2.2814873239717413, 0.99346608256523439),
            Complex::new(-0.22973851391807287, -3.5043288992695807),
            Complex::new(0.27519030929704497, -2.5580443189574442),
            Complex::new(2.3188032670667547E-002, 1.4687940182366304),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(1.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(5.3426377833023686, 4.8523801564950304),
            Complex::new(-3.2714128240356786, -1.0359025403451831),
            Complex::new(3.1409261578576793, 0.94048293875234190),
            Complex::new(1.0097660964718500, -0.20516744756494143),
            Complex::new(1.2937568953190581, 4.9639850453004977),
            Complex::new(-2.1002011867851862, 1.6974697756789301),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-1.1581700048037640, -4.5888697361727218),
            Complex::new(0.60055271355220519, -3.3577827100989825),
            Complex::new(-2.0080845488605417, -4.4700600228013201),
            Complex::new(1.4325888852512605, 2.8503115404802299),
            Complex::new(1.6369621806051240, -0.41031880478214378),
            Complex::new(2.3635290009163534E-002, 0.38291396734391636),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(2.8909324128308627, 5.8935236412196126),
            Complex::new(-3.2328856678162037, 0.75228437935122261),
            Complex::new(2.7893685593172641, 5.5392628113252673),
            Complex::new(1.6118112156701838, -1.0094698024500963),
            Complex::new(1.3608152138021676, 1.9371427332360165),
            Complex::new(-2.6140995071037043, -9.2938031637164770E-002),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.9920000681840786, -0.59215589695800697),
            Complex::new(-0.21623031283824595, 0.25536775423907221),
            Complex::new(0.67417681559451292, -0.62768062701324900),
            Complex::new(0.86870562825107700, 1.3865177094967467),
            Complex::new(0.13978137988690997, -0.12844309173767909),
            Complex::new(-0.94645138436302012, -0.16818871179222716),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(1.3191844304055609, 1.6087869992064430),
            Complex::new(-0.70457467310670596, 1.1139608481332748),
            Complex::new(0.90309893595387214, -0.34672707716144424),
            Complex::new(0.27574173257547541, 1.2977190877360101),
            Complex::new(-0.88774679178604399, 1.5925537789260493),
            Complex::new(-0.35628580468831672, -1.1233213542394909),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(2.4533085543975495, -1.2055318683997096),
            Complex::new(-2.7719800272120323, -1.7710533071221248),
            Complex::new(-0.39730657807502318, 0.40818121909325011),
            Complex::new(2.9496197992313995, -2.8325926675687545),
            Complex::new(4.0127828355636810, 0.43911745909419797),
            Complex::new(-2.0662693121153111, 5.0834559478258861),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(1.7519218537096310, -3.0898996972516994),
            Complex::new(-1.3233129155299883, 1.1374941019119689),
            Complex::new(0.20842038056621470, -1.3222091815709149),
            Complex::new(-0.68458886917775097, -1.5482290672706089),
            Complex::new(4.9207628789067126, -1.2852818822971801),
            Complex::new(0.52260472814233327, 9.2904151939808291E-002),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(-3.0351219982835431, -2.0732093812713588),
            Complex::new(2.2502166171996576, 0.46195436568975790),
            Complex::new(5.7587005825989523E-002, 1.1268024477881653),
            Complex::new(-1.4933529300405093, -2.7001393960766791),
            Complex::new(0.63391919494767979, -2.6151510932577811),
            Complex::new(1.2142554386308568E-002, 1.9724020065941743),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.4877168769618021, -5.8585309145742155),
            Complex::new(2.8084667388982907, 2.2357818972886458),
            Complex::new(0.37838517208496114, -1.7822597868027001),
            Complex::new(1.1118663889628084, 1.0002989528382991),
            Complex::new(0.61104683688653538, -0.59021813463755834),
            Complex::new(-0.53274410079727197, 0.10603004292091461),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-2.6830057394932458, -0.28891894230981152),
            Complex::new(4.0005776370406378, -4.5128021675791619),
            Complex::new(0.23644402740805845, -2.4799619370296195),
            Complex::new(-1.0464596223417642, 2.0037924783009484),
            Complex::new(-3.0754126926611791, 2.8430868624681822),
            Complex::new(-0.77321825194804572, -0.35436219241257588),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(-0.42307481028329341, -2.2423497270354478),
            Complex::new(3.2746351447542272, -1.9432355634370264),
            Complex::new(2.7070788101852035, -5.6731888887565276),
            Complex::new(-3.2613117083108358, -0.26774916122306708),
            Complex::new(-1.4220913042558818, -0.26079397359719791),
            Complex::new(1.4421082575779354, 1.8066193662368404),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.76325923409000795, -0.40661134271484961),
            Complex::new(-1.6634413952920886, 2.0359820544124569),
            Complex::new(2.4233454820463702, 3.1816091187466107),
            Complex::new(1.6818723779762133, -4.6065346655009130),
            Complex::new(3.2983677492657724, -2.7055402382999523),
            Complex::new(-0.47007091469308471, 2.2157530167190171),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.69729108957942443, -2.5760519730298737),
            Complex::new(-1.2816420392538765, 3.5514518909442758),
            Complex::new(0.88721317627163077, 1.0829884082214079),
            Complex::new(-0.88080012104639338, -2.1741376546575659),
            Complex::new(1.5936067968487480, -4.5666027972661896),
            Complex::new(2.2690316989507497, 0.45421135864604700),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-1.0221847462904883, 2.1725651912078767),
            Complex::new(2.0188557250245780, 0.73696629827009008),
            Complex::new(-1.3095784837267528, -0.37602985187054011),
            Complex::new(-1.2760185732059350, 0.95114880796237400),
            Complex::new(-2.2977827978151781, -1.8554972087834618),
            Complex::new(-1.2205058194738454, -2.5096566830325142),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(-0.75756728486039360, 6.1295413040862448),
            Complex::new(-0.50905916155491937, -1.4003664367045170),
            Complex::new(1.6532888553021676, 1.7101409523083424),
            Complex::new(-2.0984434231893774, -0.64479729117484741),
            Complex::new(-2.2906433616890358, 1.3603583920196214),
            Complex::new(0.76550673613671183, -1.7848780816230245),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(1.6014800415637274, 3.8861101634604127),
            Complex::new(-0.89555704837463657, -0.19922831713420708),
            Complex::new(0.55482823864891573, 9.8209297847796750E-002),
            Complex::new(-1.7424088901198016, -0.19526234491543665),
            Complex::new(-0.35414076940222317, 1.7210137430267756),
            Complex::new(-1.0628438175206427, -0.83377040326964191),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.0288543419192995, -7.0673263966255204),
            Complex::new(2.5301029287410541, 2.5826712075724454),
            Complex::new(1.1030686345361131, -3.0937600695596879),
            Complex::new(0.63390348263253737, 3.8224718321764495E-002),
            Complex::new(1.9344410478717518, -1.2735119165632034),
            Complex::new(0.22384277208716347, 1.2258408553913924),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-3.6151087542433240, -5.0991091781335429E-002),
            Complex::new(2.6671744589835162, -6.2234067176815824),
            Complex::new(-1.1673003572941527, -2.7780802705200855),
            Complex::new(3.8571891304950201E-002, 2.4116924839976619),
            Complex::new(-2.1802435880974498, 3.5948030821275734),
            Complex::new(-0.89718888754054560, -7.7327184383904651E-002),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(1.4795721470940053, -2.9324014121608535),
            Complex::new(2.8167480725205642, -1.0706308465310048),
            Complex::new(2.5760401663029491, -6.0107600468314306),
            Complex::new(-2.8136909521671951, 0.67225335379495665),
            Complex::new(-0.88264309754136794, -0.20502832010966976),
            Complex::new(1.2285303222760067, 1.5392275345498692),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.46485476626285965, -0.43267170079303668),
            Complex::new(-1.7729993772236257, 1.6353047534127365),
            Complex::new(1.4536722631751164, 2.5011234070456094),
            Complex::new(1.7274028886034012, -4.0306065112718663),
            Complex::new(2.9033126400769906, -1.5148670361627032),
            Complex::new(-0.28560536131304909, 2.1299193824939819),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.41189889630087051, -2.2790862354342303),
            Complex::new(-1.0995171655244558, 4.0579715752369454),
            Complex::new(0.75718814068132434, 0.49775653616599869),
            Complex::new(-0.90531176863607166, -3.1471347325547132),
            Complex::new(2.4055381210316651, -5.6129219637822425),
            Complex::new(2.0939476299508026, 0.86306851362422021),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-1.0420522144667856, 0.68331440178532354),
            Complex::new(0.67474647972265756, 0.59635943982875428),
            Complex::new(-1.9618753405517595, 0.17191074429184741),
            Complex::new(-1.3453862690943306, 1.6757275390906303),
            Complex::new(-2.0690824236932088, -0.92108732493175716),
            Complex::new(0.91633498499634736, -2.1381148436185460),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(-1.8421023514133761, 5.6934350210756088),
            Complex::new(-0.69516269306609990, -1.1606111662270542),
            Complex::new(1.3606892921118332, 1.5570740824375178),
            Complex::new(-2.3523115419205798, -0.26113293971653118),
            Complex::new(-2.5771375018147595, -0.64317795160759772),
            Complex::new(0.21103766697665177, -0.97022256287284137),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(1.2984170735620195, 3.4363691121182081),
            Complex::new(-0.55911581556757806, -0.13660864795578576),
            Complex::new(1.1062774026736437, 1.8506623054333966),
            Complex::new(-0.84633439098844265, 0.65479130001071839),
            Complex::new(-0.47157196772248078, 1.4454519852601451),
            Complex::new(-0.65774832514134296, -0.92565561968285992),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(1.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(4.2918085769962042, -6.0751660167388932),
            Complex::new(2.2038695715499683, 2.1531581107630582),
            Complex::new(2.4328679290078541, -1.8554559313760945),
            Complex::new(1.9063328296708064, -0.24112156892875430),
            Complex::new(2.3490824877864549, 0.48439118249685514),
            Complex::new(-1.3161072410735419, 1.7865869291142316),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-3.6208759269114532, -1.2175616360241943),
            Complex::new(5.0718277697592740, -7.2889973377224759),
            Complex::new(-0.40370692200667702, -4.3418623664292042),
            Complex::new(-0.76043737221052221, 3.5682295399669002),
            Complex::new(-3.3279006248787608, 4.4268501869630841),
            Complex::new(-1.1866504704396392, -0.30465587229016994),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(1.7317956089603841, -0.49103688541219626),
            Complex::new(1.9248269695199232, -1.8659699540444326),
            Complex::new(3.0117234763348399, -6.0656375217354910),
            Complex::new(-4.0512294090840042, 0.92239467640771922),
            Complex::new(-1.1069109826302885, 0.41321495696323673),
            Complex::new(1.6059259819611416, 1.3666040343219410),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.52196154056319655, -7.3942815142402030E-002),
            Complex::new(-1.2693913888660817, 1.6242592751283775),
            Complex::new(2.5394416780768498, 1.5604742552435467),
            Complex::new(1.0364490378572464, -4.1464318365224919),
            Complex::new(1.6187133358777719, -2.3298357413400104),
            Complex::new(-0.23887919038576294, 2.3721828635149094),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.84520922621496353, -2.0306735816304049),
            Complex::new(-1.7489888061113090, 4.1232597538596680),
            Complex::new(1.4839388721495250, 0.51691292696707081),
            Complex::new(0.24659996689859631, -2.8897963577015791),
            Complex::new(3.3976985009182927, -4.3499677287053382),
            Complex::new(1.6644345331414154, 0.53683515643313440),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(0.71585088459327306, 1.0979558417000270),
            Complex::new(1.2354925534454970, -0.94359057333195129),
            Complex::new(-2.4146593125766769, -0.75665630759566471),
            Complex::new(-2.1774295592325750, 1.3810070979876488),
            Complex::new(-3.2356529679360677, -0.92685449759988636),
            Complex::new(-0.14925563504454614, 0.26653846715721108),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(-1.0100552465778656, 4.5457779842942969),
            Complex::new(-0.92249138097236516, -1.4500727491261478),
            Complex::new(1.6268266536383225, 1.2578589742813135),
            Complex::new(-2.7290142678078788, -0.67264376487369670),
            Complex::new(-0.13577297506610231, -0.39095448974121894),
            Complex::new(-0.58430144053677591, -1.8621436658734820),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(1.9166603506349260, 3.2121012270292875),
            Complex::new(-0.73173931579550622, 0.24078701172934919),
            Complex::new(-1.1176229154721082, 1.9839986706563275),
            Complex::new(-2.1099488071108792, 1.4589808032036202),
            Complex::new(-0.11284308207184601, 1.3883452109598082),
            Complex::new(-0.66879380342570194, -0.42204763132531598),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-1.2876777400237049, -4.3046848475243040),
            Complex::new(-1.1376970875607770, 1.6149181880850949),
            Complex::new(1.2228680122060407, -1.0107360295733425),
            Complex::new(-1.1166962295386758, 1.7128466818299062),
            Complex::new(-2.9065888199001435, 0.10139279158079151),
            Complex::new(0.27939544316471343, -2.3208521074698938),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-0.81009645624525806, 1.2459405287462044),
            Complex::new(5.6715494281201027, -2.7010584129112569),
            Complex::new(-1.7462852905775264, 1.7644886022274335),
            Complex::new(0.47464225474195265, -0.17061369346820299),
            Complex::new(-1.4693045794839787, 0.39657174058554423),
            Complex::new(-0.50940394716140180, -3.0046823301242349),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(3.9652583038708000E-002, -3.0233879730072921),
            Complex::new(1.4989677264990013, -0.85177988640486868),
            Complex::new(0.91929528585462095, -1.4251037063186247),
            Complex::new(-0.11093459271046086, -1.3371847451355219),
            Complex::new(0.51644936453880375, 1.7613253414957397E-002),
            Complex::new(-0.73149334713773295, -4.2100235361629110),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7364310216026948E-002, 1.0316626095087102),
            Complex::new(-2.8105551147691394, 2.2590085580048225),
            Complex::new(4.0218552984848568, 2.2330157746901174),
            Complex::new(-1.6816764135304640E-002, 0.82521240528163964),
            Complex::new(0.32195979079717829, 0.22520148482711333),
            Complex::new(2.1434124116920414, 0.39658296834189855),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.40569224644850760, -1.4631689034116837),
            Complex::new(-4.6649740479126418, 3.1681241437947727),
            Complex::new(2.3795424553413360, -3.4323678296590812),
            Complex::new(-0.64476698969545843, 0.53974500999977604),
            Complex::new(-7.7606860952297296E-003, 2.0404815368284712),
            Complex::new(-0.71427347386705298, -1.0961166378954434),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-1.5223450807930470, 1.5877572067774479),
            Complex::new(2.9655108729034638, 1.0824984849067836),
            Complex::new(-1.3241231658588697, -2.7175660039789205),
            Complex::new(-1.9158258313920179E-002, -1.3074119563138180),
            Complex::new(-0.12696794740557352, -2.0233528430039645),
            Complex::new(-3.7634253995821041, 0.92628395290652255),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(3.2566925693405766, 4.7782975737867650),
            Complex::new(1.2676534847649594, -1.1434764845869951),
            Complex::new(-1.8349915084811075, 0.20988840999540426),
            Complex::new(1.5338538310828429, -1.7421235878552461),
            Complex::new(2.3100963123069853, 2.9390335214936840),
            Complex::new(-0.44579794410430340, -1.4281922587238971),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(1.8681918657483916, 2.9351078257206291),
            Complex::new(1.5515774332607888, -2.4279708360605605),
            Complex::new(-0.41464466683087031, -1.4817772045559905),
            Complex::new(0.35745451574262255, -1.8952168565050500),
            Complex::new(-5.7686689496757426E-002, 4.0815657240377390E-002),
            Complex::new(0.71839337906420686, 4.3638717290857498E-002),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-0.74654027506620757, -5.5134803295756090),
            Complex::new(-1.4160608977180136, 1.9618074983688945),
            Complex::new(1.9475514746571925, -2.3222363123303307),
            Complex::new(-1.5946591358689468, 0.75077244731337156),
            Complex::new(-1.5831946089149274, -0.58190099034485354),
            Complex::new(1.0359823160491488, -1.2010412949994160),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-1.7421994709953363, 1.4838683792746807),
            Complex::new(4.3381462500629810, -4.4116629630136774),
            Complex::new(-3.1500296752797374, 1.4663702687369675),
            Complex::new(1.5596737683886670, 0.23728631222851093),
            Complex::new(-0.57413547492024941, 1.1482879602449354),
            Complex::new(-0.63337458275390168, -2.7276473220955637),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(1.9422995404160066, -3.7134396581326978),
            Complex::new(1.0410806542653384, 2.0824830501152913E-002),
            Complex::new(0.78825664197236656, -1.7626748643935275),
            Complex::new(0.33668616343317986, -0.39718223011749842),
            Complex::new(1.0558975712533176, 7.3378906902485552E-002),
            Complex::new(-0.94507128243966165, -4.4774153678498818),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.24104015761112124, 1.0056022514305232),
            Complex::new(-2.9201130967006765, 1.8583312570051020),
            Complex::new(3.0521820796136030, 1.5525300629891161),
            Complex::new(2.8713746491883296E-002, 1.4011405595106867),
            Complex::new(-7.3095318391603437E-002, 1.4158746869643628),
            Complex::new(2.3278779650720769, 0.31074933411686334),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.12030005316995368, -1.1662031658160401),
            Complex::new(-4.4828491741832206, 3.6746438280874418),
            Complex::new(2.2495174197510295, -4.0175997017144907),
            Complex::new(-0.66927863728513670, -0.43325206789737125),
            Complex::new(0.80417063808768763, 0.99416237031241850),
            Complex::new(-0.88935754286700008, -0.68725948291727024),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-1.5422125489693443, 9.8506417354894515E-002),
            Complex::new(1.6214016276015433, 0.94189162646544777),
            Complex::new(-1.9764200226838764, -2.1696254078165329),
            Complex::new(-8.8525954202315710E-002, -0.58283322518556169),
            Complex::new(0.10173242671639599, -1.0889429591522592),
            Complex::new(-1.6265845951119109, 1.2978257923204908),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(2.1721575027875941, 4.3421912907761291),
            Complex::new(1.0815499532537789, -0.90372121410953232),
            Complex::new(-2.1275910716714419, 5.6821540124579628E-002),
            Complex::new(1.2799857123516405, -1.3584592363969299),
            Complex::new(2.0236021721812616, 0.93549717786646491),
            Complex::new(-1.0002670132643634, -0.61353673997371372),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(1.5651288977466837, 2.4853667743784245),
            Complex::new(1.8880186660678473, -2.3653511668821392),
            Complex::new(0.13680449719385757, 0.27067580302960931),
            Complex::new(1.2535290148739815, -1.0451632115788949),
            Complex::new(-0.17511788781701504, -0.23474610052625317),
            Complex::new(1.1234888714435070, -4.8246499122360509E-002),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479)
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.9096422916281544, 1.2034085963285970),
            Complex::new(-0.19413875177534923, -2.3442696055949512),
            Complex::new(1.9464392664377108, 4.9517507508849956),
            Complex::new(1.0340547442007457, 0.28893588716060326),
            Complex::new(5.3517003131500207E-003, -0.34351063948865046),
            Complex::new(-0.23138141782270227, -1.2021963555315101),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(0.45960045281749251, -2.2353081458396282),
            Complex::new(-4.9925970895424614, -1.6008542636319940),
            Complex::new(-0.89337750835347185, -1.3497813549939321),
            Complex::new(-3.1213519580381739, -2.6578564830410460),
            Complex::new(-0.49455351594407060, 0.93875159604524860),
            Complex::new(-5.0164056889139754, -1.9736803992804741),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.76847577151156399, 4.3303021532534132),
            Complex::new(-1.8392348208220199, -2.5205044053904198),
            Complex::new(0.29600740032183448, 3.7871415687866108),
            Complex::new(-1.1173948354420622, -1.1916939916014457),
            Complex::new(-1.3356099992327390, 0.64434980850432155),
            Complex::new(3.3524594402636114, 2.8046517279999028),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.25768737004332648, -0.64707798927774418),
            Complex::new(-1.9267624624599224, -1.8492791763446119),
            Complex::new(0.29989913957283232, 0.42879423511757903),
            Complex::new(-1.1339707022899357, -1.7766410268450072),
            Complex::new(-0.48239993315447283, -1.2769456221699438),
            Complex::new(-0.74683875798282684, 0.51434590764802346),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(1.0433537180198125, -1.3237701590099391),
            Complex::new(0.21849071489023797, 1.1839481314119706),
            Complex::new(-0.66613675692791885, 1.2853473340472590),
            Complex::new(-0.85294339475357628, 0.88672465786445298),
            Complex::new(0.11212643362204910, -0.48994853525986382),
            Complex::new(-0.48192425085089829, 1.2337083353554068),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(0.54507292323803047, 1.4068652463615210),
            Complex::new(-3.7962670792045543, -1.5560385328104671),
            Complex::new(3.7911783617866894, 1.9893193001505445),
            Complex::new(-0.49300550871439563, -0.29606645770526813),
            Complex::new(-0.88570869397281493, 0.70815560648187492),
            Complex::new(-1.1505367129102981, -0.61956726813375551),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(1.1223822468957279, -1.4280988498675686),
            Complex::new(-1.8383994720677506, 0.28997438910901774),
            Complex::new(3.1041057220284323, -1.6686916883528002),
            Complex::new(0.37530693191459574, -0.71825427901572625),
            Complex::new(0.34083107036415250, 2.0581299127777353),
            Complex::new(0.10214324732675245, -1.9689087625848427),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(-1.3254949515917425, 2.4727583262302915),
            Complex::new(0.45003350944482257, 1.6732536514201826),
            Complex::new(1.7488524641258163E-003, -2.8067716949413928),
            Complex::new(0.27350348103587319, 0.77854507784627458),
            Complex::new(-0.44946872904333868, 2.8547206982261146),
            Complex::new(2.2531686840963063, -2.1521860590319020),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(4.4507797565856517, -5.3868857227079570E-003),
            Complex::new(-0.47250256193258577, -1.9973802953111517),
            Complex::new(2.6711227288888626, 3.6402504681280075),
            Complex::new(0.55609183787047467, -0.67313834735593125),
            Complex::new(1.3287459112983664, -1.0268044214142955),
            Complex::new(0.52520545506173311, -8.2385543061032240E-002),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-0.47250256193258577, -1.9973802953111517),
            Complex::new(-6.3260002675995830, -3.3114588137344145),
            Complex::new(-2.2971218930556829, -1.6478996884843982),
            Complex::new(-2.0363204443914595, -2.2499564773443321),
            Complex::new(0.40061558861965874, 1.6904678157046398),
            Complex::new(-5.1403763245064749, -1.6966453912518029),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(2.6711227288888626, 3.6402504681280075),
            Complex::new(-2.2971218930556829, -1.6478996884843982),
            Complex::new(0.16496875643958009, 3.4495704107117082),
            Complex::new(-0.66977407929842148, -0.25169147658342222),
            Complex::new(-0.79616179251822528, 0.70011546199184971),
            Complex::new(3.1388815049616827, 2.5372598963129320),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.55609183787047467, -0.67313834735593125),
            Complex::new(-2.0363204443914595, -2.2499564773443321),
            Complex::new(-0.66977407929842148, -0.25169147658342222),
            Complex::new(-1.0884401916627477, -1.2007128726159602),
            Complex::new(-0.87745504234325455, -8.6272420032694280E-002),
            Complex::new(-0.56237320460279117, 0.42851227342298820),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(1.3287459112983664, -1.0268044214142955),
            Complex::new(0.40061558861965874, 1.6904678157046398),
            Complex::new(-0.79616179251822528, 0.70011546199184971),
            Complex::new(-0.87745504234325455, -8.6272420032694280E-002),
            Complex::new(0.92405775780496646, -1.5362677017759168),
            Complex::new(-0.65700831985084540, 1.6425654903335800),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(0.52520545506173311, -8.2385543061032240E-002),
            Complex::new(-5.1403763245064749, -1.6966453912518029),
            Complex::new(3.1388815049616827, 2.5372598963129320),
            Complex::new(-0.56237320460279117, 0.42851227342298820),
            Complex::new(-0.65700831985084540, 1.6425654903335800),
            Complex::new(0.98630409155989474, -0.24802542871978728),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(3.7847180342745257E-002, -1.8642051328782046),
            Complex::new(-2.0245030035789311, 0.52972965958648055),
            Complex::new(2.8115061588380978, -1.8217585582236249),
            Complex::new(0.12143881318339332, -0.33458992755740996),
            Complex::new(5.4336930238428761E-002, 5.4593569150515955E-002),
            Complex::new(-0.45232582183330755, -1.1542532438346593),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(-1.6285579195934503, 2.0230172748880868),
            Complex::new(0.78647474225188108, 1.7358733205986039),
            Complex::new(0.55319801648885369, -1.0543186873557933),
            Complex::new(1.1695779801672321, 1.6285987227724297),
            Complex::new(-0.56689992736359629, 2.5791589404594841),
            Complex::new(2.6582641764756065, -2.2440712754451200),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(1.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.8283689424185956, 6.8457752526828752),
            Complex::new(-4.2948968001052625, -2.5025015589473885),
            Complex::new(3.5184471989349513, 2.8876146576038475),
            Complex::new(1.0362240384267165, -2.3659602996113791),
            Complex::new(2.1934113240921658, 3.7161922264642158),
            Complex::new(-1.9612249336831489, 2.3171613435073390),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-3.9744306155823055, -3.2395590063808601),
            Complex::new(1.4944247452173542, -5.5863482114847942),
            Complex::new(-3.5575130404106861, -3.7239465223880606),
            Complex::new(1.8411115127185540, 2.5121894432588125),
            Complex::new(-0.32092005599940598, 2.1951628098371452),
            Complex::new(-0.33137274402718181, 0.28727947961136407),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(2.4408713663295885, 4.0906750461689105),
            Complex::new(-5.2130275786988021, -2.9555035339923692),
            Complex::new(-0.73795206669616220, 0.39208284126760973),
            Complex::new(2.1445134609624761, 0.16521900847121240),
            Complex::new(2.8684018438942593, 4.7821867769182322),
            Complex::new(-1.0194560751178705, 1.6192798133345434),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.29331208291188982, -1.7278851267102249),
            Complex::new(3.1437287645915704, 1.3446069090052153),
            Complex::new(4.4678213327810186, -1.0255714659436133),
            Complex::new(-1.9711965620384884, -2.9636310841360181),
            Complex::new(-0.70407409465557558, -2.1317228371315209),
            Complex::new(0.31375398462627763, 1.7957050846861771),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(1.3454595542633692, 2.2067017812079825),
            Complex::new(0.17726534019505191, 1.4284038836243576),
            Complex::new(3.8194204604513811, 4.1830998906463979),
            Complex::new(1.7324369450783110, -1.0594157571010796),
            Complex::new(1.4554949388239926, 2.8198769011035982),
            Complex::new(-2.4847838333500434, -0.42537683269406157),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(1.3366281785376153, 2.1710567096992035),
            Complex::new(0.51883491259475101, -1.0253418456430761),
            Complex::new(-1.8496357068279230, 0.86333626167495936),
            Complex::new(-0.56501547643925309, 1.2587211625622681),
            Complex::new(-3.2218412807835151, -0.10491064817110482),
            Complex::new(-1.6141820441138848, 0.39205818805249898),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(1.5360272204005236, -5.4663609921080276),
            Complex::new(0.93522875414935980, 2.1555781999828931),
            Complex::new(-2.7457798461243357, 0.18874990163953620),
            Complex::new(1.3724336513755033, 1.1564669591190131),
            Complex::new(2.9077878229280349, -0.39242022731738979),
            Complex::new(-0.81876403355545324, -2.4195836869565381),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(1.9769249549719594, -2.2964971037134028),
            Complex::new(-0.83987549540722273, 3.1105907114368527),
            Complex::new(-2.8541797639862589, 5.3046963267592673E-002),
            Complex::new(-0.99844894311910282, 1.0045043819556907),
            Complex::new(1.4613563705577874, -2.6690315541861764),
            Complex::new(0.67848121370666536, 3.2485541199276519E-002),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.56541470734169130, 5.8536148727962471),
            Complex::new(-3.9686634429141763, -2.0729884621380013),
            Complex::new(2.1886479044632106, 1.6493105194202540),
            Complex::new(-0.23620530861155303, -2.0866140123608603),
            Complex::new(1.7787698841774622, 1.9582891274041572),
            Complex::new(-0.42127492052244336, 1.7564152697844995),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-3.9686634429141763, -2.0729884621380013),
            Complex::new(-0.91022856555840259, -4.5207575914438998),
            Complex::new(-4.3211064756981621, -2.1601644264789419),
            Complex::new(2.6401207762340264, 1.3556523872895743),
            Complex::new(0.82673698078190483, 1.3631157050016349),
            Complex::new(-4.1911161128088181E-002, 0.51460816751762928),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(2.1886479044632097, 1.6493105194202540),
            Complex::new(-4.3211064756981612, -2.1601644264789415),
            Complex::new(-1.1736353767280530, 0.44696031617167009),
            Complex::new(3.3820519178792852, -8.4922314141550048E-002),
            Complex::new(3.0926697289831799, 4.1639434998453257),
            Complex::new(-1.3968517348030054, 1.7919033135624716),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.23620530861155301, -2.0866140123608599),
            Complex::new(2.6401207762340264, 1.3556523872895743),
            Complex::new(3.3820519178792852, -8.4922314141549826E-002),
            Complex::new(-1.2802427112923338, -2.8478057588853924),
            Complex::new(0.58052520954364328, -1.3167541319542138),
            Complex::new(0.26702781369899148, 1.5534416036652496),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(1.7787698841774622, 1.9582891274041572),
            Complex::new(0.82673698078190483, 1.3631157050016349),
            Complex::new(3.0926697289831799, 4.1639434998453257),
            Complex::new(0.58052520954364328, -1.3167541319542138),
            Complex::new(0.46333455893736541, 1.5569226660266944),
            Complex::new(-2.0552707365406562, -9.9143475502975711E-002),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-0.42127492052244325, 1.7564152697844997),
            Complex::new(-4.1911161128088251E-002, 0.51460816751762950),
            Complex::new(-1.3968517348030054, 1.7919033135624716),
            Complex::new(0.26702781369899148, 1.5534416036652496),
            Complex::new(-2.0552707365406562, -9.9143475502975614E-002),
            Complex::new(-0.54859142407299111, -2.0125951227232579),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(0.70398011556501350, -4.3187039553267166),
            Complex::new(1.1625574420556251, 2.4450397828819868),
            Complex::new(-3.0119172076508249, 0.48796500979574048),
            Complex::new(1.7491363772628019, 1.5679777842761784),
            Complex::new(0.46642329617937750, -0.64464368918376858),
            Complex::new(-2.3424926042025479E-002, -1.5276625839558975),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(1.3586816778990529, -2.0722292186244822),
            Complex::new(-0.66725199517929457, 2.7331950517517178),
            Complex::new(-0.63027944584050710, -8.0289401955338235E-002),
            Complex::new(0.26516547300333376, 0.20031487876278925),
            Complex::new(1.1026274849071527, -2.6119247798858396),
            Complex::new(0.68952669199102434, -0.47112244715826745),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'n',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.4277242384193973E-002, 7.0624103548475521),
            Complex::new(-3.6902996327569393, -2.4198777724218008),
            Complex::new(1.4639644420120586, 2.9608108021772419),
            Complex::new(0.24175759771871802, -1.1245397778443258),
            Complex::new(0.45537567319224587, 2.6415829093298022),
            Complex::new(-1.1778617934068787, 0.63660445731402160),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-3.0365604281640981, -2.3109163126664773),
            Complex::new(0.42317461249871874, -2.8101530413414797),
            Complex::new(-2.9173620909959506, -1.8620460929884759),
            Complex::new(1.5550892625873121, 0.94775238159286035),
            Complex::new(-6.8432123781824283E-002, 0.61139948534224386),
            Complex::new(8.2059474464411697E-002, 0.23757315948895810),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.28600094708591139, 2.3393622045456595),
            Complex::new(-3.8632194034644978, -3.0327691433849631),
            Complex::new(-1.0425967328457988, 0.78453147424657310),
            Complex::new(2.9344311617356444, -1.0249248291595738),
            Complex::new(2.5532215222686658, 4.1081778463577976),
            Complex::new(-1.1832737995010767, 2.0592951452494428),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.53460977643870122, -2.0605536542826730),
            Complex::new(2.7496787581655631, 1.7563296882892945),
            Complex::new(4.3517251367505390, 0.59556339755945142),
            Complex::new(-1.3257732219195217, -3.4237339131144400),
            Complex::new(0.97558031873242479, -2.5074273340914632),
            Complex::new(8.2562260318955846E-002, 1.6392752378902848),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(1.4933776908989083, 1.6613233898085138),
            Complex::new(0.64461210705248406, 0.85659602070896579),
            Complex::new(3.2226947645734860, 4.7491753719007344),
            Complex::new(0.60503685713332156, -0.34375705405706641),
            Complex::new(-0.34859676524555194, 2.6032418325427469),
            Complex::new(-1.8801866675407091, -0.50800063048114896),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-0.40140745234614589, 3.2456660592070530),
            Complex::new(1.3021980841738321, 0.65521502595896530),
            Complex::new(-0.74455487797799869, 1.2439627174000840),
            Complex::new(0.33639550958738701, 0.82886287253699331),
            Complex::new(-2.2839711106626255, -1.0335533593546806),
            Complex::new(-2.6854322285431835, -2.3841369621372257),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(1.7885151821179959, -3.8825976723160802),
            Complex::new(1.3486609735668056, 2.2052845124045239),
            Complex::new(-2.7193176444604905, 0.64103187966656505),
            Complex::new(2.0030044959940043, 1.1843134328178624),
            Complex::new(0.75291743630510122, 1.3588926544434505),
            Complex::new(0.53104414311803450, -2.3423181027060807),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(1.6617446459007608, -1.6224881672822773),
            Complex::new(-1.0036932279863531, 2.6705753825732965),
            Complex::new(-1.1817286098652349, -1.8327424095409381),
            Complex::new(-0.63090902612802524, -0.64973876616336579),
            Complex::new(1.2200586832274105, -2.3363630221192091),
            Complex::new(0.28443119961172436, -0.37923723074504945),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.8196284538355458, -4.2996580157711106),
            Complex::new(0.45734796133360955, 2.8388425183224153),
            Complex::new(-1.5013115133408128, -0.87751837232925389),
            Complex::new(1.8892081183447096, 1.9344024594218006),
            Complex::new(-0.79598865149631037, -0.96908403989201441),
            Complex::new(0.58906618887295070, -0.85935903128309243),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-1.4982436710722351, 1.8295192701688159),
            Complex::new(5.3183765821356861, -7.5876661982521991),
            Complex::new(1.1670895062939062, 2.2268025019283249),
            Complex::new(-1.6470707251294971, -3.5676640005956148),
            Complex::new(-0.49997600812399035, 1.0883817216415144),
            Complex::new(2.1952765649333856, -2.6421368220818242),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.21811007379003433, -0.25723043573330351),
            Complex::new(-0.77553609186819106, 0.62889301912765494),
            Complex::new(2.9026993264039649, -6.1296367340227684),
            Complex::new(-0.34044501424212709, -2.3621096609325098),
            Complex::new(-0.53691941948845623, -3.7235346179717299E-002),
            Complex::new(2.6674768453128817, -1.1583386459580689),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.9757767624629965, -0.32530470929358923),
            Complex::new(2.7852762659006518, -1.3714762599359638),
            Complex::new(1.9255606839696517, -0.37788781790985637),
            Complex::new(0.83654133978866008, -2.6340956883647433),
            Complex::new(-0.26441810770634999, -1.2507483452160089),
            Complex::new(2.1424623995832146, -2.6068507436967758E-002),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(0.54742935438160178, -1.8184509856239055),
            Complex::new(-1.7871565933077898, 0.47633900148100994),
            Complex::new(0.11486254555456127, 0.59618020296347507),
            Complex::new(0.52282343457805314, 1.4091155360784073),
            Complex::new(-3.2771315599721129E-002, -0.77172075030795217),
            Complex::new(-0.26524520459442386, 1.4776512170289295),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-1.0967721074301739, 0.69443423755029332),
            Complex::new(1.6282824605005524, -2.9904090194366253),
            Complex::new(-7.6215872863775180E-003, -3.3081643013284214),
            Complex::new(-1.4543775449277387, -2.4867694780908165),
            Complex::new(-1.2911173489954964, 0.68548945818705842),
            Complex::new(0.20149107900190577, -5.8276492577923413),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(-1.5406923567757924, -0.46501488646685485),
            Complex::new(1.3575059813474573, -1.0568234499978022),
            Complex::new(-1.4354008882371929, 0.79073096309137392),
            Complex::new(0.19568636296598083, -0.66368940786922326),
            Complex::new(-4.8551396509539380E-002, 2.5799940115246076),
            Complex::new(-0.45900973107536047, -2.8209087503259562),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(0.80669332169935126, 4.1225608707336638),
            Complex::new(-1.2719421237726531, -2.7603847164776596E-002),
            Complex::new(-2.4242069127391241, -2.7629718596765369),
            Complex::new(-3.3551490492381930, -0.27416575871110116),
            Complex::new(-2.6752908806698006E-002, 2.7401980493192077),
            Complex::new(-2.5113098663629576, -2.4789891260386558),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        'n',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.3607659187930432, -5.5084534978224156),
            Complex::new(0.17898415117637301, 3.1857318286062148),
            Complex::new(-0.77662805088966114, -2.1890186550862420),
            Complex::new(1.4112452120144385, 0.97232822490526605),
            Complex::new(0.52740555948890600, -1.6523778218176595),
            Complex::new(1.3456530617573861, 0.26045178118738532),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-2.4303466858223133, 2.0674471206972922),
            Complex::new(3.9849734040785649, -9.2982707483546196),
            Complex::new(-0.23665487840830501, 1.9286841684378591),
            Complex::new(-0.56203921148278280, -3.1597639948989009),
            Complex::new(0.39519309643973899, 1.8400979413009055),
            Complex::new(2.0713059293408858, -2.3651018140531530),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(2.1207570311673329, -0.94728212085870922),
            Complex::new(-1.2334231641018540, 1.5014977360336765),
            Complex::new(2.7716606825217105, -6.4672078920976714),
            Complex::new(0.10717574190151363, -1.4221071459144861),
            Complex::new(2.5287872260576858E-003, 1.8530307307810853E-002),
            Complex::new(2.4538989100109529, -1.4257304776450399),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.6773722946358482, -0.35136506737177631),
            Complex::new(2.6757182839691147, -1.7721535609356840),
            Complex::new(0.95588746509839795, -1.0583735296108576),
            Complex::new(0.88207185041584801, -2.0581675341356962),
            Complex::new(-0.65947321689513172, -6.0075143078759302E-002),
            Complex::new(2.3269279529632501, -0.11190214166200296),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(0.83282154766015570, -1.5214852480282619),
            Complex::new(-1.6050317195783690, 0.98285868577367919),
            Complex::new(-1.5162490035745159E-002, 1.0948330908065832E-002),
            Complex::new(0.49831178698837492, 0.43611845818125994),
            Complex::new(0.77916000858319623, -1.8180399168240051),
            Complex::new(-0.44032927359437096, 1.8865083720071028),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-1.1166395756064713, -0.79481655187225997),
            Complex::new(0.28417321519863181, -3.1310158778779611),
            Complex::new(-0.65991844411138423, -2.7602237051660339),
            Complex::new(-1.5237452408161343, -1.7621907469625604),
            Complex::new(-1.0624169748735268, 1.6198993420387635),
            Complex::new(2.3383318834720987, -5.4561074183783731),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(-2.6252274233287749, -0.90112116947749077),
            Complex::new(1.1714024498362767, -0.81706817952033939),
            Complex::new(-1.7280004514275273, 0.63766409322054929),
            Complex::new(-5.8181755765221582E-002, -0.28002505641090703),
            Complex::new(-0.33504553663526310, 0.57645766789738850),
            Complex::new(-1.0134788002354205, -2.0062532315757728),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(0.50363035369764342, 3.6728198193914592),
            Complex::new(-0.93550089096559463, 3.5015822013644726E-002),
            Complex::new(-1.8727577487143963, -1.0105188520909372),
            Complex::new(-2.4590745501068341, 0.57588788621505393),
            Complex::new(-0.14418410712695562, 2.4646362915525772),
            Complex::new(-2.1062143739836574, -2.5708743424518739),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.5385460832679669, 5.0690152586597081),
            Complex::new(-0.87403902197839800, -3.7691885022136624),
            Complex::new(1.9140254885133325, 4.7636593972279444),
            Complex::new(2.5270697488146867, 1.1189451907892667E-002),
            Complex::new(0.42910054933443709, 2.0436681273282624),
            Complex::new(-6.1181417546944727E-002, -2.7399841207848903),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-2.0130764520945146, -0.84431729406427247),
            Complex::new(-0.47069741916643015, -0.58158753995566848),
            Complex::new(-0.93722018011335173, 1.8457418203551164),
            Complex::new(-1.8048698148425042, -0.14148677317328284),
            Complex::new(-0.95027213708358227, 0.29695644985116076),
            Complex::new(-3.2087554653423718, -0.50813830199009047),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(-9.1520093991360074E-002, 0.39223048569415409),
            Complex::new(-2.3137909119143538, -3.7788826437982230),
            Complex::new(2.4847238931676281, 5.9317114443042307),
            Complex::new(-0.85921335545086119, -0.62703399022920947),
            Complex::new(-0.36310000222884242, -0.42164912145004435),
            Complex::new(0.26905532925182346, 1.6041401026677333),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.56106771839356728, 0.10023919776376478),
            Complex::new(2.3411561306982702, 2.0944517855107119),
            Complex::new(3.8190228914582462, -0.57912541336185752),
            Complex::new(1.5141289683700436, 0.92641488051832521),
            Complex::new(-0.48111489377041072, -0.15029248925437355),
            Complex::new(3.5971975359896087, -2.4520385922407382),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(0.59372326212580129, 2.9091162086447957),
            Complex::new(2.6024943436570145, -1.7488855939103223),
            Complex::new(1.7151081344813948, 1.9041313282185193),
            Complex::new(1.4488923316758069, 1.6595226913367753),
            Complex::new(-2.6918384958555883, 1.3759187103651978),
            Complex::new(5.3544374488064870, 3.6027476784153967E-002),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-0.54038370544818359, 2.6259744913786442),
            Complex::new(1.6572061182101778, 0.75084951369151742),
            Complex::new(-2.3391983099638334, -0.46825512757162424),
            Complex::new(-0.92380985940191085, -1.1350309239414109),
            Complex::new(-0.15547308200089907, -1.7314978809001098),
            Complex::new(-3.1375194965446105, 2.3072607976361614),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(-2.5928045659138039, -2.5663482933865591),
            Complex::new(0.13950376570458456, 1.8101560578598437),
            Complex::new(-0.28371278516671494, -1.6963584044946460),
            Complex::new(-1.4992215503392261, 0.42407705231309789),
            Complex::new(-1.9154880248899508, 0.29214608972165701),
            Complex::new(0.58608817660956292, 2.1418437624735391),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(0.26688042031916215, -1.6134463686323126),
            Complex::new(-3.7328432388295463, 1.5568438906213706),
            Complex::new(-0.70032758917519633, -4.2073084229332203),
            Complex::new(-2.6275472719887603, -1.7627577611524732),
            Complex::new(0.19085108885961843, -0.11999828389145634),
            Complex::new(-2.0306778826051053, 1.0207520805142891),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        't',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(4.0796835482254643, 3.8602197766084032),
            Complex::new(-1.1524028321356345, -3.4222991919298629),
            Complex::new(2.6387089509644843, 3.4521591144709562),
            Complex::new(2.0491068424844157, -0.95088478260864184),
            Complex::new(1.7524947603196535, 1.3603743454026174),
            Complex::new(0.69540545533749065, -1.6201733083144128),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-2.9451794668445928, -0.60638944353579616),
            Complex::new(-1.8041005972235518, -2.2921920900580890),
            Complex::new(-2.3409645648155628, 1.5476234868646503),
            Complex::new(-0.71983830119578995, 0.26641323252343108),
            Complex::new(-5.5103032519852990E-002, 1.0486726695105519),
            Complex::new(-3.3327261009348716, -0.23110329396141926),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(1.8111268633859385, -0.29782119943125163),
            Complex::new(-2.7716779841480168, -2.9062779268922014),
            Complex::new(2.3536852492853737, 5.5941402862293277),
            Complex::new(-0.41159259930722053, 0.31296852478881404),
            Complex::new(0.17634820448567146, -0.36588346796251620),
            Complex::new(5.5477393949894760E-002, 1.3367482709807623),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.26266325056641915, 7.4178839685577702E-002),
            Complex::new(2.2315981487667331, 1.6937744845109917),
            Complex::new(2.8493496725869925, -1.2596111250628588),
            Complex::new(1.5596594789972316, 1.5023430347473723),
            Complex::new(-0.87617000295919245, 1.0403807128828759),
            Complex::new(3.7816630893696441, -2.5378722264657734),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(0.87911545540435521, 3.2060819462404391),
            Complex::new(2.7846192173864353, -1.2423659096176531),
            Complex::new(1.5850830988910882, 1.3188994561631100),
            Complex::new(1.4243806840861286, 0.68652561343962792),
            Complex::new(-1.8799071716726710, 0.32959954384914480),
            Complex::new(5.1793533798065399, 0.44488463176232718),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-0.56025117362448096, 1.1367237019560910),
            Complex::new(0.31309687290825722, 0.61024265525018162),
            Complex::new(-2.9914951667888401, 7.9685468590763309E-002),
            Complex::new(-0.99317755529030638, -0.41045219281315459),
            Complex::new(7.3227292121070431E-002, -0.79708799704840483),
            Complex::new(-1.0006786920744175, 2.6788026370501297),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(-3.6773396324667864, -3.0024545763971950),
            Complex::new(-4.6599765806595972E-002, 2.0499113283373065),
            Complex::new(-0.57631234835704936, -1.8494252743654707),
            Complex::new(-1.7530896690704285, 0.80774140377141412),
            Complex::new(-2.2019821650156746, -1.7113902539055621),
            Complex::new(3.1619107449502915E-002, 2.9564992812237225),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(-3.6182547682545696E-002, -2.0631874199745175),
            Complex::new(-3.3964020060224875, 1.6194635597997920),
            Complex::new(-0.14887842515046845, -2.4548554153476205),
            Complex::new(-1.7314727728574011, -0.91270411622631797),
            Complex::new(7.3419890539360835E-002, -0.39556004165808689),
            Complex::new(-1.6255823902258053, 0.92886686410107111),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-6.1500438761697414, 0.91676218319253766),
            Complex::new(3.5513411029856878, -1.8725969124236601),
            Complex::new(-5.0443221170537527, 1.7815102541278283),
            Complex::new(-0.24664239933464849, -1.1775443933504470),
            Complex::new(-3.5171099373794799, 0.35243496558863330),
            Complex::new(-6.2947828051592936E-002, -2.7407411539012854),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(3.4023707943114747, 1.4765888004304639),
            Complex::new(4.2374737353952749, 1.4362002122560311),
            Complex::new(1.8975097219086821, 3.0606261330433640),
            Complex::new(-0.78151126190520992, 0.29709548869654701),
            Complex::new(-1.6165507017720082, 1.1408477346611656E-002),
            Complex::new(2.5897529978319271, 1.9769368947246266),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(-2.9360362770799613, -0.82684794768927894),
            Complex::new(4.4739352151447358, -0.86985699563820029),
            Complex::new(-5.5431218238369269, 2.4912059417117076),
            Complex::new(-0.39039619224796890, -0.42611233745095733),
            Complex::new(-0.39611754497192547, -0.43579949771463050),
            Complex::new(-0.79267249989422695, 1.1491138643464012),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.17097311988904368, 0.26742260661323425),
            Complex::new(-2.6560015565570594, -4.7187344885985860E-002),
            Complex::new(-8.3263206307371940E-002, -2.2515338359121757),
            Complex::new(-2.2090613105721975, -0.66923818675056912),
            Complex::new(0.24593109115317413, 0.16129866482933353),
            Complex::new(-0.95473933547180612, -4.4028687907513788),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-3.2133243262466502, 1.2775242924371235),
            Complex::new(-1.2029075227147334, -3.3797722006490840),
            Complex::new(-1.9182008359011142, 0.34699882394760972),
            Complex::new(-1.4549590730581896, 0.41501487580464025),
            Complex::new(0.24588078336315844, 2.6349413300718920),
            Complex::new(-3.7190414743748983, -3.8526065681799078),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-0.41689721067740748, 2.6788972778560662),
            Complex::new(0.68628050565219834, 0.33473851325986215),
            Complex::new(2.6576936101864308, 1.6732701026307231),
            Complex::new(1.0515417177842015, -0.28845162851873785),
            Complex::new(0.29799972291665666, -1.5371523820460204),
            Complex::new(-3.3865402735295742, 2.2005376014414648),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(5.7948225854380961, 1.0283492612506000),
            Complex::new(-1.2661773065742703, 1.2077212783994682),
            Complex::new(2.0292953822177049, -0.70506913362947299),
            Complex::new(0.87797921268987078, 1.4428774371591229),
            Complex::new(3.0443851104182165, 2.4178061255196392),
            Complex::new(-1.6082505673237000, 1.2014128188316171),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(1.8220487762119173, -0.94694560684347517),
            Complex::new(0.83318983965261673, 3.5137153210552712),
            Complex::new(1.3288795985618007, -3.3376481502499455),
            Complex::new(0.95896829926825622, -0.22567957193089871),
            Complex::new(0.35323683461731087, -5.0404388901855557E-002),
            Complex::new(4.3368007326707647E-002, 1.9096289409433400),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        'c',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-5.6089064112122440, -0.29203329885876728),
            Complex::new(3.2729772928284513, -1.5257076021398606),
            Complex::new(-4.3196386546026009, 0.47000997137084011),
            Complex::new(-0.72460530566491954, -2.1396186278669815),
            Complex::new(-2.1937157263942635, -0.33085881633701175),
            Complex::new(0.69363904483284244, -1.6209303414308074),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(2.4702677795613965, 1.7145166509589402),
            Complex::new(2.9040705573381533, -0.27440433784638940),
            Complex::new(0.49376533720647098, 2.7625077995528979),
            Complex::new(0.30352025174150443, 0.70499549439326092),
            Complex::new(-0.72138159720827888, 0.76312469700600283),
            Complex::new(2.4657823622394273, 2.2539719027532978),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(-1.0333893197026627, -1.5168996328146847),
            Complex::new(4.0160481429110728, 2.7477212678213014E-003),
            Complex::new(-5.6741604677191813, 2.1536347836368046),
            Complex::new(5.7224563895671821E-002, 0.51389017756706623),
            Complex::new(0.14333066174258841, -0.38003384422710235),
            Complex::new(-1.0062504351961556, 0.88172203265943017),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.12743134793810451, 0.24136224853504717),
            Complex::new(-2.7655595384885965, -0.44786464588570618),
            Complex::new(-1.0529364251786257, -2.9320195476131770),
            Complex::new(-2.1635307999450095, -9.3310032521522035E-002),
            Complex::new(-0.14912401803560760, 1.3519718669665830),
            Complex::new(-0.77027378209177044, -4.4887024249764140),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-2.9279321329680963, 1.5744900300327671),
            Complex::new(-1.0207826489853127, -2.8732525163564149),
            Complex::new(-2.0482258714914208, -0.23823304810779955),
            Complex::new(-1.4794707206478679, -0.55798220209250704),
            Complex::new(1.0578121075460758, 1.5886221635558391),
            Complex::new(-3.8941255433748454, -3.4437494132017346),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(-0.43676467885370485, 1.1896464884335129),
            Complex::new(-0.65782873964972222, 0.19413165481852632),
            Complex::new(2.0053967533614241, 2.2212106987931106),
            Complex::new(0.98217402189580594, 0.43612710260951848),
            Complex::new(0.52670009703862619, -0.60274249819431525),
            Complex::new(-1.2496994690593812, 2.5720794408554331),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(4.7102875188851137, 0.59224297823996408),
            Complex::new(-1.4522808380854508, 1.4474765488769310),
            Complex::new(1.7366958190273707, -0.85813600350029762),
            Complex::new(0.62411109395866837, 1.8265417886174391),
            Complex::new(2.7578909702924927, 0.41426978189242025),
            Complex::new(-2.1627196364837600, 2.0160683375818005),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(1.5189858082102095, -1.3966866581856801),
            Complex::new(1.1696310724596752, 3.5763349902336925),
            Complex::new(1.8803287625865286, -1.5851951426643458),
            Complex::new(1.8550427983996152, 0.62437407299525638),
            Complex::new(0.23580563629705326, -0.32596614666848611),
            Complex::new(0.44846349970600774, 1.8177437245301220),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.8),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.9662382698970875, -2.0530064297387383),
            Complex::new(-0.16566178800321951, 2.0315047686864234),
            Complex::new(-0.38620288809997882, -1.7003378831363722),
            Complex::new(1.0340649521920033, 2.6346015263248330),
            Complex::new(0.18984068857561254, 1.4284340848302317),
            Complex::new(-0.60133781234231343, -2.6983092383997600),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(1.0590944192764742, 2.0470223780157060),
            Complex::new(1.5362309226730355, -4.4733378729943656),
            Complex::new(2.5143241756448425, 3.5904641914052320),
            Complex::new(-2.3324965747943232, -1.3736732601341644),
            Complex::new(-1.3307325220258206, 0.45595976858170939),
            Complex::new(2.5359736395518007, -1.6995204331579026),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(-0.55312120765047212, -3.2774338977239088),
            Complex::new(-0.27517960515425433, -1.6121287859899063),
            Complex::new(0.86383317637964707, -1.4488731831572050),
            Complex::new(-0.39220337059255928, -1.4577285139278198),
            Complex::new(-1.3207898487439298, -0.76977502554621102),
            Complex::new(4.1076176331932643, -2.1361187125788117),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.1928338144108308, 0.54503279437246466),
            Complex::new(0.77774079187475498, 3.7968497481497998),
            Complex::new(-2.2595258003240897, -0.45900484904412320),
            Complex::new(-1.0799521591340557, 0.36958292441776330),
            Complex::new(-0.57982293514072381, -0.16127684822808552),
            Complex::new(-2.0149239521336999, -1.3855612887492010),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(0.64206533777186903, -1.0141299132555142),
            Complex::new(0.24854602982260321, 5.2739185823623771),
            Complex::new(1.4879302282060944, -3.8144873772657073),
            Complex::new(0.79981737000314257, 1.1588526278722129),
            Complex::new(-2.0864424504400287, 1.1496178729667861),
            Complex::new(1.2861047516169348, -0.23881163545053613),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(1.0121300475780082, 2.6739608948819784),
            Complex::new(-0.45615820581901767, -0.38393120350382026),
            Complex::new(3.5864532049429783, -0.61303315416867354),
            Complex::new(0.55247173780875525, -1.0624276583543844),
            Complex::new(0.48968426694509803, -1.7590733075657838),
            Complex::new(-1.9548632943877771, 1.7013820419892762),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(-3.5578500664407011, 1.8577791355219724),
            Complex::new(9.4625880057405298E-002, -1.6462026294281489),
            Complex::new(1.7187570531033243, 1.7329235942744154),
            Complex::new(0.35483128904400951, -2.2474189916985101),
            Complex::new(-1.7865225219801513, 1.1833396357063339),
            Complex::new(1.6885936017695036, -0.51345297285159130),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(-2.5760846495535086, 1.0304177824689875),
            Complex::new(7.4317551938250181E-002, -3.0610822497096288),
            Complex::new(-0.84180371271215515, -1.6648453774686487),
            Complex::new(-1.0037348754404496, -2.4785837715562491),
            Complex::new(0.40819071243113431, 0.24047741225782382),
            Complex::new(-1.1449782488550009, -0.75494916857884609),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.3, -0.7),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(4.5073757348545849, -3.2618019117900432),
            Complex::new(-0.44402559816045606, 2.3783940789702229),
            Complex::new(0.33848057435117296, -3.0118381658933604),
            Complex::new(0.55610204586173217, 1.6725272918082985),
            Complex::new(1.5132348995608289, 0.74514030290458666),
            Complex::new(0.15524906054212201, -1.5784984259292822),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(0.12699140452639590, 2.2849502285441825),
            Complex::new(0.20282774461591391, -6.1839424230967861),
            Complex::new(1.1105797909426314, 3.2923458579147660),
            Complex::new(-1.2474650611476088, -0.96577325443745043),
            Complex::new(-0.43556341746209132, 1.2076759882411006),
            Complex::new(2.4120030039593008, -1.4224854251292314),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(1.3495257497268265, -3.9674855828493145),
            Complex::new(-0.73306667738791731, -0.73952406908388457),
            Complex::new(0.73279453249739268, -1.7864443412321078),
            Complex::new(5.5417385551081444E-002, -0.51772599890979609),
            Complex::new(-0.78134164202941592, -0.71400937205868287),
            Complex::new(3.8940396978913352, -2.4035105442657825),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.89442934658368256, 0.51897243629427758),
            Complex::new(0.66818280994321788, 3.3961724471500796),
            Complex::new(-3.2291990191953435, -1.1394905607451244),
            Complex::new(-1.0344216485068678, 0.94551107864681039),
            Complex::new(-0.97487804432950553, 1.0293963539091640),
            Complex::new(-1.8304583987536645, -1.4713949229742362),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(0.92745753105042295, -0.71716417565987056),
            Complex::new(0.43067090355202398, 5.7804382666550467),
            Complex::new(1.3579051926157879, -4.3997192493211168),
            Complex::new(0.77530572241346429, 0.18585554997506562),
            Complex::new(-1.2745111262571114, 0.10329870645073308),
            Complex::new(1.1110206826169877, 0.17004551952763708),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(0.99226257940171081, 1.1847101054594251),
            Complex::new(-1.8002674511209382, -0.52453806194515606),
            Complex::new(2.9341563481179715, -6.5092558006285994E-002),
            Complex::new(0.48310404192035972, -0.33784892722612803),
            Complex::new(0.71838464106706756, -0.82466342371407875),
            Complex::new(0.18197751008241592, 2.0729238814032445),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(-4.6423851329936836, 1.4216728525113365),
            Complex::new(-9.1477651453775233E-002, -1.4064473589506861),
            Complex::new(1.4261574899129899, 1.5798567244035908),
            Complex::new(0.10096317031280710, -1.8637546402401939),
            Complex::new(-2.0730166621058750, -0.82019670792088517),
            Complex::new(1.1341245326094436, 0.30120254589859213),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(-2.8791476175552164, 0.58067673112678264),
            Complex::new(0.41075878474530869, -2.9984625805312075),
            Complex::new(-0.29035454868742722, 8.7607630116951093E-002),
            Complex::new(-0.10766037630909076, -1.6285301266300940),
            Complex::new(0.29075951411087669, -3.5084345508806722E-002),
            Complex::new(-0.73988275647570079, -0.84683438499206409),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.0, 0.0),
        &a,
        8,
        &b,
        8,
        Complex::new(1.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.2629542350769043, 0.99216037988662720),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(0.37739565968513489, -0.17262350022792816),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
            Complex::new(0.99216037988662720, 1.2629542350769043),
            Complex::new(-0.42951309680938721, -0.32623335719108582),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(1.7579030990600586, 0.41464143991470337),
            Complex::new(0.56074607372283936, -1.5399500131607056),
            Complex::new(-0.45278397202491760, -0.92856705188751221),
            Complex::new(-0.83204329013824463, -0.29472044110298157),
            Complex::new(-1.1665705442428589, -5.7671726681292057E-003),
            Complex::new(-1.0655906200408936, 2.4046533107757568),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(0.83204710483551025, -1.1476570367813110),
            Complex::new(-0.22732868790626526, -0.28946158289909363),
            Complex::new(0.26613736152648926, -0.29921510815620422),
            Complex::new(-0.37670272588729858, -0.41151082515716553),
            Complex::new(2.4413645267486572, 0.25222346186637878),
            Complex::new(-0.79533910751342773, -0.89192110300064087),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(0.61824327707290649, -0.22426788508892059),
            Complex::new(-0.17262350022792816, 0.37739565968513489),
            Complex::new(-2.2239003181457520, 0.13333636522293091),
            Complex::new(-1.2636144161224365, 0.80418950319290161),
            Complex::new(0.35872888565063477, -5.7106774300336838E-002),
            Complex::new(-1.1045478284358978E-002, 0.50360798835754395),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.0, 0.0),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.2),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(5.4158771845083997E-002, 0.45102292971347158),
            Complex::new(2.0655948231457888E-002, -0.15114929305239455),
            Complex::new(1.8299031530306209E-002, 0.51362069418461154),
            Complex::new(0.31035513148240934, 0.19861661491716820),
            Complex::new(-0.26865233583230275, 0.43450891426963967),
            Complex::new(-0.42013922363727119, -0.19584079080582839),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(0.23216067777440957, -0.23446754687603627),
            Complex::new(0.69404879650546292, 0.26781254213769046),
            Complex::new(0.46547511317543844, -0.16003773450907666),
            Complex::new(-0.39110926972492432, 7.1505559556269027E-002),
            Complex::new(-0.39594083422334236, -6.3121987329751050E-002),
            Complex::new(-1.2426579183736131E-002, -0.10335805570122680),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(-0.43782821950060447, 0.53871760575052496),
            Complex::new(-1.9316399385279404E-002, -0.33745204713124100),
            Complex::new(9.8112158449175313E-002, 7.6161168160455928E-002),
            Complex::new(-0.29753596033954555, -0.19747942980348210),
            Complex::new(-0.16850223494324434, 7.8795079570935345E-002),
            Complex::new(0.11000383362179744, 4.0954432501709936E-002),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-8.3167133229481160E-002, 6.0324423168963526E-002),
            Complex::new(0.10293069486216744, 9.8512503482587666E-002),
            Complex::new(0.40528371937995722, 2.9024053052426169E-002),
            Complex::new(-0.11502570681312241, -0.16135583760374539),
            Complex::new(-9.3926121203990576E-002, -0.41991360813250544),
            Complex::new(-3.9107462601474852E-002, 5.7797931250898993E-002),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.13634459877527649, -3.6979535773091543E-002),
            Complex::new(-0.14295196597206539, -0.11683669413382847),
            Complex::new(0.14151887024222118, 0.14918142667683101),
            Complex::new(0.17891467480234313, 0.28185002627745304),
            Complex::new(-5.4158771845083997E-002, 0.45102292971347158),
            Complex::new(-2.0655948231457888E-002, -0.15114929305239455),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(0.26865233583230275, 0.43450891426963967),
            Complex::new(0.42013922363727119, -0.19584079080582839),
            Complex::new(9.5156617390462994E-002, -0.27627020889923282),
            Complex::new(-0.10746457140839949, -0.22535274960626284),
            Complex::new(-0.23216067777440957, -0.23446754687603627),
            Complex::new(-0.69404879650546292, 0.26781254213769046),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(0.39594083422334236, -6.3121987329751050E-002),
            Complex::new(1.2426579183736131E-002, -0.10335805570122680),
            Complex::new(0.11307049562142035, -6.6155494245223601E-003),
            Complex::new(6.9616199577096083E-003, -0.15764271255795226),
            Complex::new(0.43782821950060447, 0.53871760575052496),
            Complex::new(1.9316399385279404E-002, -0.33745204713124100),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(0.16850223494324434, 7.8795079570935345E-002),
            Complex::new(-0.11000383362179744, 4.0954432501709936E-002),
            Complex::new(-0.47144734369884933, -0.41811279681493030),
            Complex::new(-0.41356079002560353, -9.1884983955099919E-002),
            Complex::new(8.3167133229481160E-002, 6.0324423168963526E-002),
            Complex::new(-0.10293069486216744, 9.8512503482587666E-002),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.0, 0.0),
        &a,
        8,
        &b,
        8,
        Complex::new(0.0, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(8, 8);
    complex::gemm(
        'c',
        't',
        6,
        8,
        4,
        Complex::new(0.0, 0.0),
        &a,
        8,
        &b,
        8,
        Complex::new(0.2, 0.0),
        &mut c,
        8,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.25259085077927779, 0.19843207893419379),
            Complex::new(-6.5246672410468332E-002, -8.5902620641926219E-002),
            Complex::new(0.26595986285745887, 0.24766083132715266),
            Complex::new(0.25448587319978877, -5.5869258282620571E-002),
            Complex::new(8.2928289218668461E-002, 0.35158062505097121),
            Complex::new(-0.30799000722154979, 0.11214921641572140),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-1.1534345508133551E-003, -0.23331411232522292),
            Complex::new(0.48093066932157669, -0.21311812718388623),
            Complex::new(0.15271868933318089, -0.31275642384225755),
            Complex::new(-0.15980185508432765, 0.23130741464059668),
            Complex::new(-0.22953141077654671, 0.16640942344679566),
            Complex::new(-5.7892317442481467E-002, -4.5465738258745336E-002),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(5.0444693124960249E-002, 0.48827291262556471),
            Complex::new(-0.17838422325826020, -0.15906782387298080),
            Complex::new(8.7136663304815620E-002, -1.0975495144359693E-002),
            Complex::new(-0.24750769507151382, 5.0028265268031724E-002),
            Complex::new(-4.4853577686154500E-002, 0.12364865725708984),
            Complex::new(7.5479133061753689E-002, -3.4524700560043753E-002),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.1421355030258817E-002, 7.1745778199222343E-002),
            Complex::new(0.10072159917237755, -2.2090956897898861E-003),
            Complex::new(0.21715388621619169, -0.18812983316376553),
            Complex::new(-0.13819077220843390, -2.3165065395311490E-002),
            Complex::new(-0.25691986466824801, -0.16299374346425743),
            Complex::new(9.3452343247120706E-003, 4.8452696926186922E-002),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-8.6662067274184018E-002, 4.9682531501092475E-002),
            Complex::new(-0.12989433005294693, 1.3057635919118460E-002),
            Complex::new(0.14535014845952610, 3.8312782173049176E-003),
            Complex::new(0.23038235053989808, 5.1467675737554952E-002),
            Complex::new(0.19843207893419379, 0.25259085077927779),
            Complex::new(-8.5902620641926219E-002, -6.5246672410468332E-002),
            Complex::new(1.2383041381835938, 1.3297992944717407),
            Complex::new(-0.27934628725051880, 1.2724293470382690),
            Complex::new(0.35158062505097121, 8.2928289218668461E-002),
            Complex::new(0.11214921641572140, -0.30799000722154979),
            Complex::new(-9.0556795754384911E-002, -0.18571341314484791),
            Complex::new(-0.16640866050733116, -5.8944089098931673E-002),
            Complex::new(-0.23331411232522292, -1.1534345508133551E-003),
            Complex::new(-0.21311812718388623, 0.48093066932157669),
            Complex::new(-1.5637820959091187, 0.76359343528747559),
            Complex::new(1.1565370559692383, -0.79900926351547241),
            Complex::new(0.16640942344679566, -0.22953141077654671),
            Complex::new(-4.5465738258745336E-002, -5.7892317442481467E-002),
            Complex::new(5.3227473098448996E-002, -5.9843022522971356E-002),
            Complex::new(-7.5340546300121325E-002, -8.2302166257830933E-002),
            Complex::new(0.48827291262556471, 5.0444693124960249E-002),
            Complex::new(-0.15906782387298080, -0.17838422325826020),
            Complex::new(-5.4877474904060364E-002, 0.43568331003189087),
            Complex::new(0.25014132261276245, -1.2375384569168091),
            Complex::new(0.12364865725708984, -4.4853577686154500E-002),
            Complex::new(-3.4524700560043753E-002, 7.5479133061753689E-002),
            Complex::new(-0.44478007025688981, 2.6667273441959516E-002),
            Complex::new(-0.25272288699035172, 0.16083790303525181),
            Complex::new(7.1745778199222343E-002, -1.1421355030258817E-002),
            Complex::new(-2.2090956897898861E-003, 0.10072159917237755),
            Complex::new(-0.94064915180206299, 1.0857694149017334),
            Complex::new(-0.11582532525062561, -0.69095385074615479),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::gemm(
            'x',
            't',
            6,
            8,
            4,
            Complex::new(0.0, 0.0),
            &a,
            8,
            &b,
            8,
            Complex::new(0.2, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::gemm(
            'c',
            'x',
            6,
            8,
            4,
            Complex::new(0.0, 0.0),
            &a,
            8,
            &b,
            8,
            Complex::new(0.2, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::gemm(
            'n',
            'n',
            6,
            8,
            4,
            Complex::new(0.0, 0.0),
            &a,
            4,
            &b,
            8,
            Complex::new(0.2, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::gemm(
            'n',
            'n',
            6,
            8,
            4,
            Complex::new(0.0, 0.0),
            &a,
            8,
            &b,
            3,
            Complex::new(0.2, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::gemm(
            'n',
            'n',
            6,
            8,
            4,
            Complex::new(0.0, 0.0),
            &a,
            8,
            &b,
            8,
            Complex::new(0.2, 0.0),
            &mut vec![],
            5,
        );
    });
    assert!(result.is_err());
}

#[test]
fn trmm() {
    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut b = mat.clone();
    complex::trmm(
        'l',
        'u',
        'n',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-0.41405065468799945, -1.5191217029575041),
            Complex::new(-0.69490876638628207, -1.4153085671446701),
            Complex::new(-0.83419064198640946, -0.50555104393530281),
            Complex::new(0.34645774818088582, 0.28057501053159395),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.94240802378391497, 1.8194772369531083),
            Complex::new(-2.9153658882833628, -2.3126831220695263),
            Complex::new(-1.5721870875427124, 0.75999293033223214),
            Complex::new(0.79851111695362287, 0.41539800883503275),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.30059598777530616, -4.7622991935580838E-004),
            Complex::new(-0.40030704404913392, 0.64982639160988953),
            Complex::new(0.33213353316073702, 0.20926732060823242),
            Complex::new(1.2837599485019321E-002, -0.19049002371540899),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.76325512471628953, 0.79546193461507575),
            Complex::new(-0.83792405458526675, 0.51076886233492236),
            Complex::new(-3.6959496736776953E-002, -5.4805674326484782E-002),
            Complex::new(0.12676149970562242, 6.4043945950648051E-002),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.6508024981725062, -0.64423594455874311),
            Complex::new(0.37551185028990675, 7.4690390701194542E-002),
            Complex::new(-0.10496880817482218, 0.15546792320308533),
            Complex::new(-0.11660175095677679, -0.20949314958488327),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.67662846150460598, 0.40970986840795259),
            Complex::new(0.18500013285725259, 1.1724732013706247),
            Complex::new(0.51842448361866889, 1.3901729555213557E-002),
            Complex::new(-0.15617033770313232, -0.15971929721539613),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'u',
        'n',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-0.41405065468799945, -1.5191217029575041),
            Complex::new(-4.5878528270079100E-002, -1.6328225075105753),
            Complex::new(-1.4266711201397058, 1.3912352824123402),
            Complex::new(0.47796290633027105, 0.96207423451653451),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.76589425391122323, 0.98606678861933172),
            Complex::new(-1.7952358832719872, -2.3286074808032682),
            Complex::new(-0.42450625879478310, 0.20280603525803245),
            Complex::new(1.3334031780571216, 1.7106045501024205),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.59457311678842317, -0.75219244957874709),
            Complex::new(-9.2946084873448687E-003, 0.39429243933295322),
            Complex::new(-7.1771211921762917E-002, 4.0015163033017165E-002),
            Complex::new(0.21906001894265437, -0.40454921133144506),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.89429376859854393, 1.1330330926899785),
            Complex::new(-0.63534501209259031, -1.0787114552230488),
            Complex::new(-0.75266008085101577, 1.6310068561511820E-002),
            Complex::new(0.21357793530192870, 0.26739183168697100),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.9492069659996545, -0.61817558648055604),
            Complex::new(0.18397794917513985, 0.68461246633872708),
            Complex::new(1.3359479596257482, 0.78149896871615987),
            Complex::new(-4.5530510627187937E-002, -0.57592815422904708),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.7695659025695811, -6.3875064777400237E-002),
            Complex::new(-3.4141288894177890E-002, 0.37099623206041554),
            Complex::new(6.8604956493863833E-002, -0.29596711801438530),
            Complex::new(-0.18212487372942077, -0.50651968429266925),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'n',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.37066642795896643, -0.12937536991789439),
            Complex::new(-0.53847920794539261, -0.90801649455416311),
            Complex::new(1.4384450317723125, -1.1169017108178481),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.92898483439414603, -0.19018934561877915),
            Complex::new(0.57848959639076525, -1.2758597080561640),
            Complex::new(1.3474196179958526, -2.5611815252913859),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.0000000000000000, -0.0000000000000000),
            Complex::new(-0.29787973916147625, 0.60822070451199339),
            Complex::new(-0.45228594812363454, -2.2680385476264697),
            Complex::new(-1.2911708889627647, -1.5158614406578568),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.54795774185350954, 0.48306801661471988),
            Complex::new(-1.1615060277364126, 1.0118885323693230),
            Complex::new(-1.4892507275872222, -1.1002656652229008),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.0000000000000000, 0.0000000000000000),
            Complex::new(0.40963463948849754, -8.9577905665065391E-002),
            Complex::new(-0.43354575166980625, -0.41052366517593775),
            Complex::new(5.8696244842979695E-002, 0.10846525402097236),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.74215273248827995, 0.12542282209793743),
            Complex::new(1.7852967366485175, 1.2067822355121136),
            Complex::new(-0.24207421890203995, -1.2786381411846650),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'n',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.27836381015723655, -0.34688931028379955),
            Complex::new(-1.1309596860986888, 0.98876983179347988),
            Complex::new(1.5699501899216979, -0.43540248683290739),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.17651376987269174, -0.83341044833377653),
            Complex::new(0.19114517061722991, -0.20611370435252130),
            Complex::new(1.7261704251386947, -1.8330466031303638),
            Complex::new(1.8823116790993515, -1.2659749840239980),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.89516910456372933, -0.75171621965939117),
            Complex::new(9.3132696400312798E-002, 0.35268675223505719),
            Complex::new(-0.85619069320613450, -2.4372907052016850),
            Complex::new(-1.0849484695051297, -1.7299206282738928),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.13103864388225439, 0.33757115807490279),
            Complex::new(-0.34537869936083304, -1.1064123009432514),
            Complex::new(-1.8772066118506514, 1.0830042752573195),
            Complex::new(-1.4024342919909158, -0.89691777948657769),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.29840446782714819, 2.6060358078187074E-002),
            Complex::new(0.21810073837373067, 0.52034416997246713),
            Complex::new(1.0073710161307641, 0.21550738033713684),
            Complex::new(0.12976748517256848, -0.25796975062319144),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.0929374410649750, -0.47358493318535277),
            Complex::new(-0.96129415423971043, -0.67605414721227164),
            Complex::new(1.3354772095237124, 0.89691338794251474),
            Complex::new(-0.26802875492832845, -1.6254385282619381),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut mat2 = fixtures::complex::matrix_mxn(6, 6);
    mat2[0] = Complex { re: 0.0, im: 0.0 };
    mat2[30] = Complex { re: 0.0, im: 0.0 };

    let a = mat2.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        'n',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, -0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.74545578758485487, 9.8755997113184890E-002),
            Complex::new(-0.92898483439414603, -0.19018934561877915),
            Complex::new(0.79406741038861639, -1.5951187526018875),
            Complex::new(1.0221070516320989, -2.7233636737611393),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.22735583281902055, 0.18780057023632762),
            Complex::new(-0.26124426021125918, 0.72410698226569692),
            Complex::new(-0.45228594812363454, -2.2680385476264697),
            Complex::new(-1.3040084884477841, -1.3253714169424478),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.76325512471628953, 0.79546193461507575),
            Complex::new(-0.73568199780245913, 0.34435907640969454),
            Complex::new(-1.3747179018729143, 1.0839642544183627),
            Complex::new(-1.4892507275872222, -1.1002656652229006),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.2462339501523765, -0.43452275964895037),
            Complex::new(0.66985596056305741, -0.40963884907530390),
            Complex::new(-0.75833799382131772, -1.9739152075580129),
            Complex::new(-0.35217871501270248, 0.88540810150424742),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.8401026154629083, 0.15865960269230969),
            Complex::new(-0.11242079794698363, 0.94650556496923932),
            Complex::new(0.53881340035045766, 0.58176305552934204),
            Complex::new(-1.6019671547082783, -1.4204888527818205),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let a = mat.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        'n',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.27836381015723655, -0.34688931028379955),
            Complex::new(-0.72468346245115178, 1.3115002827569882),
            Complex::new(0.47796290633027105, 0.96207423451653451),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.17651376987269174, -0.83341044833377653),
            Complex::new(0.19114517061722991, -0.20611370435252130),
            Complex::new(2.1988465083684905, -1.1276187450483688),
            Complex::new(1.3251943645016633, 0.60084017125167333),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1357211635016546, -0.55060255578260042),
            Complex::new(-0.17390910356897638, 0.33118569648332224),
            Complex::new(-0.85619069320613450, -2.4372907052016850),
            Complex::new(-1.1270680619558762, -1.9092679197542792),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.78656763826347009, 1.0282555521697014),
            Complex::new(-0.85210609902704482, -0.31816043104760328),
            Complex::new(-1.7009542344509263, 0.95612287888179470),
            Complex::new(-1.4024342919909158, -0.89691777948657769),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.9492069659996545, -0.61817558648055604),
            Complex::new(0.59361258866363742, 0.59503456067366178),
            Complex::new(0.90240220795594195, 0.37097530354022212),
            Complex::new(1.3165734215791744E-002, -0.46746290020807468),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.5522010148990604, -5.0652033084237352E-002),
            Complex::new(-0.70434820883860283, 0.78971031125986146),
            Complex::new(2.5455767640142994, 1.4239340453601215),
            Complex::new(-0.44625571973813855, -2.2045862330913715),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut mat2 = fixtures::complex::matrix_mxn(6, 6);
    mat2[0] = Complex { re: 0.0, im: 0.0 };
    mat2[1] = Complex { re: 0.0, im: 0.0 };
    let a = mat2.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        'n',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-1.5855558497137823, -0.88679594688315189),
            Complex::new(-0.16263993725816017, -0.59613755871067520),
            Complex::new(-1.0223398005499513, 1.7784779276016929),
            Complex::new(2.6967577459040637, 0.37291596442254626),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-1.4550636105777630, 3.9484377185545276),
            Complex::new(-1.4668178548226742, -2.3536669078064918),
            Complex::new(0.33118719205881808, -1.0349663957667417),
            Complex::new(1.1515637421064389, -1.6259125522497935),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.94921398100179522, -1.3703864354141615),
            Complex::new(-1.0130910644010049, 1.6811452270216223),
            Complex::new(-1.0662469530871845, 3.2400811621777010),
            Complex::new(1.2091099992327403, 0.32906473142285109),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.40639367076936217, -0.99002941370790132),
            Complex::new(-0.20458752516298695, -0.25098793402106362),
            Complex::new(0.82465362581920520, -1.8718384058185786),
            Complex::new(-1.9466246653527595, -8.8695100984435421E-002),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.57036966417670953, 0.45236320338369213),
            Complex::new(0.25453548380504148, -0.71809771747508244),
            Complex::new(-0.63245831397658492, -1.7474209774115350),
            Complex::new(-0.29667373591331025, 0.70915291624679455),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.3808390416288232, -0.26427329740880573),
            Complex::new(-0.36936674334809128, -0.51925889350289378),
            Complex::new(-0.25232593636761924, -0.41552068140220522),
            Complex::new(-7.9444826994691242E-002, -0.63033368764190212),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ],
        1E-5
    );

    let a = mat.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        'n',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-2.0011012320269455, -0.69072463433261544),
            Complex::new(-0.25494255505989005, -1.0724022389123691),
            Complex::new(-2.1532994866486401, 2.7672477593951728),
            Complex::new(3.4744471146982159, 0.20421980543002827),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.53309405312021629, 3.0162712731075665),
            Complex::new(-0.34668784981129874, -2.3695912665402337),
            Complex::new(1.7359662900386923, -0.56746638821322293),
            Complex::new(1.4546510549760030, 1.6982912927630189),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-2.3122909773224705, -2.1087895614330892),
            Complex::new(-0.92575590775872207, 1.2882239412392475),
            Complex::new(-1.4701516981696845, 3.0708290046024858),
            Complex::new(1.3860504257246484, -0.25483177138898028),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.42970618431654273, -0.75723579615327563),
            Complex::new(-0.32101162638757264, -0.91350744147836149),
            Complex::new(0.49841729324119322, -1.9996797813551468),
            Complex::new(-1.8598082297564531, 0.11465278475188753),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.13260335167056853, 0.26871037655208646),
            Complex::new(0.17829211190562150, 0.28657569227388313),
            Complex::new(1.0282818878006750, 0.59746953368669975),
            Complex::new(6.8670713315183970E-002, -0.64371808546552767),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.0929374410649750, -0.47358493318535277),
            Complex::new(-0.40133057238654146, -0.36112240494970083),
            Complex::new(-0.28539219327855392, -0.29696573759564360),
            Complex::new(-0.18212487372942077, -0.50651968429266925),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut mat2 = fixtures::complex::matrix_mxn(6, 6);
    mat2[0] = Complex { re: 0.0, im: 0.0 };
    mat2[6] = Complex { re: 0.0, im: 0.0 };
    let a = mat2.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        't',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.80360148607009863, -1.2966782756548307),
            Complex::new(-0.72840520031893596, 0.70958618054844980),
            Complex::new(-0.42560235060906071, 0.77769248040365224),
            Complex::new(-0.27678585145094492, 1.1468217123407773),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-1.4738609879037909, 0.80834217766163474),
            Complex::new(0.58640633529412922, 0.96682899167147351),
            Complex::new(1.0049561183225213, -0.26669771568822748),
            Complex::new(0.79868302758779752, -1.9049819683022284),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.42560235060906082, 0.77769248040365235),
            Complex::new(1.4776322015523173, 0.43873014239376767),
            Complex::new(2.1769827423749217, -0.45338466957056028),
            Complex::new(-0.55753175924381959, -0.15683583700867554),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.36198407928577808, 0.50026970868546716),
            Complex::new(-7.6257736361221740E-002, -0.35868550178546099),
            Complex::new(-0.59965135169456618, -0.33618312848906179),
            Complex::new(0.24286860372209002, 0.78433687712996214),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.2079338108206821, -0.11352827495281692),
            Complex::new(-9.8948131295274078E-002, -0.87413012598105055),
            Complex::new(-0.89278717640259830, -1.8856919508018803),
            Complex::new(-0.53353125603634632, 0.40534044116477896),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.3808390416288232, -0.26427329740880573),
            Complex::new(-0.36936674334809128, -0.51925889350289378),
            Complex::new(-0.25232593636761924, -0.41552068140220522),
            Complex::new(-7.9444826994691242E-002, -0.63033368764190212),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        'c',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.88413225780280391, 3.5365290312112156),
            Complex::new(0.23049135604138971, -0.76831558403966627),
            Complex::new(0.60538659511159443, -0.33675159754694883),
            Complex::new(5.1135244164336124E-002, 0.31930091820410589),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(7.6476354588525641E-002, -0.17696880204670801),
            Complex::new(0.63821565790157031, 2.5528626316062808),
            Complex::new(1.2252455562261795, 1.6605643502742038),
            Complex::new(-2.0881982473190148, 0.43895243955561353),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.69263598276761806, -1.2245953077145752E-002),
            Complex::new(-0.76533527789176059, 1.3317231836276520),
            Complex::new(0.58121247821662603, 2.3248499128665041),
            Complex::new(0.38960418749372067, -0.53269441917795068),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.54640540337432653, 0.33367302859355708),
            Complex::new(0.10830410679399463, -0.43544176321032629),
            Complex::new(-0.77681008911382610, -0.26053509884876885),
            Complex::new(0.21782701220686007, 0.87130804882744006),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.1473127021466114, -0.64178235396557448),
            Complex::new(-0.76586265750711346, -0.68018138205777434),
            Complex::new(-2.0133138785636668, -0.29425112677260773),
            Complex::new(0.38578941017656743, 0.33810626909249047),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.1370958875071255, -0.82678278720841325),
            Complex::new(-0.55522804897371414, -0.31270337894923239),
            Complex::new(-0.40516729696746967, -0.26863595497405601),
            Complex::new(-0.34013873176868742, -0.53659824959017932),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let a = mat.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        'c',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.0975822800182025, 4.3903291200728098),
            Complex::new(0.12760523749832176, -0.46704938051864731),
            Complex::new(-0.87708709858386569, 1.6177219532921399),
            Complex::new(-1.4835904302906053, 0.29670771595802359),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.38842123088837754, -1.4028694431728281),
            Complex::new(1.0890749734962946, 1.5273526653605487),
            Complex::new(2.2340921110675858, 0.57696423954685860),
            Complex::new(1.0614831415358890, 1.5442579498655480),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.6555934364546592, -1.2271249663133155),
            Complex::new(-0.53054138907503723, 1.0047883335719767),
            Complex::new(0.27638780759211024, 2.0104182730420739),
            Complex::new(0.78187593340837447, -0.99999081107510046),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.40654746006137599, 0.52122594740403128),
            Complex::new(-0.33265304316152478, -0.94342154726724980),
            Complex::new(-1.1222993462868680, -0.20213359911586032),
            Complex::new(0.39695967563949031, 1.0009187930372172),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.48681643885820763, -0.33905457526875138),
            Complex::new(-0.18902710702717307, 0.14591937433802404),
            Complex::new(0.75657544192683979, 0.47013272906839260),
            Complex::new(-0.18759298484934420, -0.94055285003602984),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.0929374410649750, -0.47358493318535277),
            Complex::new(-0.40133057238654146, -0.36112240494970083),
            Complex::new(-0.28539219327855392, -0.29696573759564360),
            Complex::new(-0.18212487372942077, -0.50651968429266925),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        't',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, -0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.74545578758485487, 9.8755997113184890E-002),
            Complex::new(-0.75324451429914752, -0.39265469604202657),
            Complex::new(0.32704638353984439, -0.82202196011892226),
            Complex::new(1.2876119054703419, -2.1327513303616947),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.50534217392263092, -0.21442243626824406),
            Complex::new(0.36368186249006157, -0.70613568236521862),
            Complex::new(-2.7395031753961647, -0.25623058934581977),
            Complex::new(1.4742247368639692, 0.48520215164836378),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.27069557709676256, -1.4408250671297336),
            Complex::new(0.80104014931274903, -2.3429315095287957),
            Complex::new(1.2610128627274675, 0.55727787369740334),
            Complex::new(5.7903235640717785, 3.9312031217165710),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.6137084509525672, -3.3241435705303868),
            Complex::new(-0.69718875941521663, -0.41142164376826551),
            Complex::new(-2.7676538957388477, -3.5544077706871899),
            Complex::new(3.4553003268013560, 1.2305711295775565),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(2.9159067910592666, 2.0230227013901896),
            Complex::new(-2.5937574716388743, 1.1974729524258667),
            Complex::new(-0.86996143321297437, -0.28693208145023652),
            Complex::new(-4.2688440645033303, -1.5747115626841861),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut mat2 = fixtures::complex::matrix_mxn(6, 6);
    mat2[0] = Complex { re: 0.0, im: 0.0 };
    mat2[29] = Complex { re: 0.0, im: 0.0 };
    let a = mat2.clone();
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        't',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.27836381015723655, -0.34688931028379955),
            Complex::new(-0.72468346245115178, 1.3115002827569882),
            Complex::new(0.47796290633027105, 0.96207423451653451),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.17651376987269174, -0.83341044833377653),
            Complex::new(0.36688549071222848, -0.40857905477576872),
            Complex::new(1.7318254815197185, -0.35452195256540342),
            Complex::new(1.5906992183399060, 1.1914525146511177),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.8684191702433062, -0.95282556228717208),
            Complex::new(0.45101701913234438, -1.0990569681475932),
            Complex::new(-3.1434079204786647, -0.42548274692103505),
            Complex::new(1.6511651633558773, -9.8694351163467475E-002),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.24738306354958201, -1.2080314495751079),
            Complex::new(0.68461604808816334, -3.0054510169860937),
            Complex::new(0.93477653014945550, 0.42943649816083518),
            Complex::new(5.8771399996680849, 4.1345510074528935),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.91073543510528943, -3.5077963973619921),
            Complex::new(-0.77343213131463662, 0.59325176598069995),
            Complex::new(-1.1069136939615880, -1.2095172595889556),
            Complex::new(3.8206447760298499, -0.12229987213476567),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(2.6482619617292493, 1.8847858699956568),
            Complex::new(-2.5337710479612436, 1.3103454268495009),
            Complex::new(-0.78347996939081122, -0.43509003877870955),
            Complex::new(-4.5089230042775732, -1.4129562619614073),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        'c',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.27836381015723655, -0.34688931028379955),
            Complex::new(-0.72468346245115178, 1.3115002827569882),
            Complex::new(0.47796290633027105, 0.96207423451653451),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.17651376987269174, -0.83341044833377653),
            Complex::new(0.66487249453236275, -0.16945725049517865),
            Complex::new(0.60521238569303681, -0.97704402889329045),
            Complex::new(0.76425225068447145, 1.6020351707669773),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(7.6044990337531204E-002, -0.54099403311368255),
            Complex::new(0.53026247041002827, -0.37296042718609101),
            Complex::new(0.65978377841827551, 3.5440021563467341),
            Complex::new(4.2764413044570349E-002, 1.8285965014649763),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(2.0951127473062900, -1.5062738982448116),
            Complex::new(1.9442693783645022, -1.4635635455859775),
            Complex::new(0.84936080151773674, 1.8055481545990144),
            Complex::new(1.9988175236763277, 7.4083501851845668),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.6545957269940992, 1.9979637069394474),
            Complex::new(2.0930886407551093, -1.0842007024239364),
            Complex::new(3.5873425340599190, 3.1859618664091780),
            Complex::new(-1.3115239513208590, 2.2479205698486275),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.0631408799427013, 0.38373508406534801),
            Complex::new(-1.0368134258781332, -1.3392003038132692),
            Complex::new(0.57404130196598691, -3.5755577606890991),
            Complex::new(0.49453806642375003, -4.1450339641797251),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        'c',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, -0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.64141135534959504, 0.39249019279234365),
            Complex::new(0.21401317893763838, 0.85605271575055353),
            Complex::new(-0.40363416914836958, 0.10655608183405463),
            Complex::new(-2.3854291381704322, 0.49672966045704314),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(1.0390024440245722, 0.67388498012248721),
            Complex::new(0.29546858159330480, -4.6025577130415884E-002),
            Complex::new(0.96460844904279130, 3.8584337961711643),
            Complex::new(-0.34950733287008329, 2.2958928933621263),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(1.9552548039933393, -1.6938268170552857),
            Complex::new(2.3852265283200214, -0.95558376152905389),
            Complex::new(1.1948500586907784, 1.7471466548661059),
            Complex::new(1.8196848602436977, 7.2787394409747899),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.99409946370569546, 1.6952359282426244),
            Complex::new(1.5162530902751685, -1.9103014588197347),
            Complex::new(0.81745321356941236, 2.4215780105681777),
            Complex::new(-0.73814155629494738, 3.5265796889771472),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.1072993263848516, 3.0537230042287533E-002),
            Complex::new(-1.1907109024653060, -1.2907812778128007),
            Complex::new(0.45426619827707126, -3.5472279780675109),
            Complex::new(0.33652420838448333, -4.1751125294772349),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416)
        ]
    );

    let a = mat.clone();

    let mut b = mat.clone();
    complex::trmm(
        'r',
        'l',
        'c',
        'u',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-3.8107374280249573E-003, -0.83204329013824463),
            Complex::new(-0.97145990607709720, -0.99938044736261133),
            Complex::new(2.1095273020221761, -0.42793347361473799),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.61409738558958860, -0.24858058290286267),
            Complex::new(-0.28281741882520250, -0.73353243284192793),
            Complex::new(4.3634682890396119, 0.26613736152648926),
            Complex::new(2.1638677380218803, 0.48751141899630657),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-1.1558772903269556, -2.9078602176900858),
            Complex::new(-1.1499955134459103, -2.7178355651022663),
            Complex::new(2.3739862645994934, -0.46820441992672013),
            Complex::new(9.3035934685464170, -0.17262350022792816),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.8638997077444621, 2.5342195548594928),
            Complex::new(-0.65991592220785034, -2.7813397425090356),
            Complex::new(4.8032911048067461, -3.2833553245537517),
            Complex::new(2.2588700628324627, 2.2041224304301528),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.84838005047449583, -1.1072937862687229),
            Complex::new(-1.8596191095034653, 0.70337610919250393),
            Complex::new(-4.2148538954385284, -2.0339725290479649),
            Complex::new(-4.7914039773363903, -1.6389562884364799),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut b = mat.clone();
    complex::trmm(
        'r',
        'u',
        'c',
        'u',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(5.4879113183147608, 0.0000000000000000),
            Complex::new(-0.51193889959982997, -0.28749126939602698),
            Complex::new(1.6452354797736968, 1.5076677268362355),
            Complex::new(-8.7282224128367281E-002, 1.8326674541971397),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-1.7646761512277145, 4.4357493568634165E-002),
            Complex::new(2.1172016257860871, -0.83204329013824463),
            Complex::new(1.3358673534043253, -2.4586482588701930),
            Complex::new(2.1289749509222951, -0.79461016941762352),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.9306156482045029, 1.5868378526793676),
            Complex::new(1.0260623215377946, 0.91969230684614178),
            Complex::new(2.4464884634740116, 0.26613736152648926),
            Complex::new(-0.94649625380552649, -1.2139689656482757),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.49363420721920326, 0.63159286930898451),
            Complex::new(-1.2077468150121478, 0.11387959400272329),
            Complex::new(-0.56789226881724841, 1.2609010947498187),
            Complex::new(1.2943043477099385, -0.17262350022792816),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.25570642625344142, -0.67244714606845735),
            Complex::new(0.11607364248358060, 0.26530229088395729),
            Complex::new(0.77561950556013648, -0.75181441192620013),
            Complex::new(-1.1617071547461155, -5.5935561119040189E-002),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'u',
        't',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.37066642795896637, -0.12937536991789439),
            Complex::new(-0.29163650516331752, -0.54815499446876470),
            Complex::new(-0.55955982623885359, 3.7336090567630764E-002),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.0546992161128539, 0.30769421901217936),
            Complex::new(8.2398666254513975E-003, 1.4010951255374888),
            Complex::new(0.11753648309305995, 1.3217121569037471),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.0000000000000000, 0.0000000000000000),
            Complex::new(0.22381768062330257, 1.0818360809917658),
            Complex::new(1.6850995150621415, 0.15300599796037123),
            Complex::new(-0.32629307536500785, -0.22190535570622069),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.61903115607519377, 0.27668814981831602),
            Complex::new(-0.33913067485002718, -3.1415331990811701E-002),
            Complex::new(1.1469169235729075, 0.93424402758150493),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.0000000000000000, 0.0000000000000000),
            Complex::new(0.58998015244965418, -9.8330804296849372E-002),
            Complex::new(-9.1088388869482798E-002, -0.36462661872837543),
            Complex::new(-1.1191619149239813, -0.20332913599157931),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.4114865153211158, 0.38524537384662705),
            Complex::new(-0.66176873834509842, 1.6615566400565469),
            Complex::new(1.1286101466529936, -0.18935841879185145),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ],
        1E-5
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'u',
        'c',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.20658741812567161, 0.33384611099939526),
            Complex::new(0.56415772813611242, -3.5864145744237699E-002),
            Complex::new(0.55639669371665934, 0.95915212435948338),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.0000000000000000, 0.0000000000000000),
            Complex::new(0.36928125955106716, 1.4771250382042687),
            Complex::new(-1.3224202310964879, 0.88706104385778084),
            Complex::new(-0.87697445703111332, 0.34538926500849226),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(1.3655580312964728, 0.47749750643288325),
            Complex::new(0.46104884191169448, 1.8441953676467779),
            Complex::new(-0.47288022033304189, 3.0710173006515615E-002),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.63952079500403669, -0.34952714820199982),
            Complex::new(0.62031596362369024, -0.16585541403550869),
            Complex::new(0.47833016477305745, 1.9133206590922298),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.10038099205145037, -0.18624235722792018),
            Complex::new(0.13231295562736090, -0.33437467113953340),
            Complex::new(0.11867863234141812, -1.5055976296596021),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.38168423312950805, 0.70712566556379863),
            Complex::new(-1.4437390741996847, -0.18775508138812175),
            Complex::new(0.80760542532107915, 0.42138113884269468),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'u',
        'c',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.27836381015723655, -0.34688931028379955),
            Complex::new(-0.72640119980556284, 1.4751914913261448),
            Complex::new(1.0200550955487424, 1.4756360886047346),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.17651376987269174, -0.83341044833377653),
            Complex::new(0.82014057514579153, 0.45161507195853645),
            Complex::new(-4.8096421601923317E-002, 0.82600902281652555),
            Complex::new(0.24849869396138569, 1.1802423586533526),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.89516910456372933, -0.75171621965939117),
            Complex::new(1.2955602277309608, 1.5665683118121054E-002),
            Complex::new(0.15622417128717869, 1.5297637278223477),
            Complex::new(-0.40632720262437055, -0.25897882906927494),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.13103864388225439, 0.33757115807490279),
            Complex::new(-0.72214573317092912, -1.1941277724081236),
            Complex::new(-6.5701972724606039E-002, -0.38187431597790589),
            Complex::new(0.65746282820568758, 2.0429314033020063),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.29840446782714819, 2.6060358078187074E-002),
            Complex::new(0.37484682644882089, 0.24136575091516732),
            Complex::new(1.2110243796907718, 0.80778891840012790),
            Complex::new(-9.0875950546492890E-003, -1.8563133620805055),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.0929374410649750, -0.47358493318535277),
            Complex::new(-1.2017646027949078, 0.57349751601671528),
            Complex::new(-1.7354912455895453, -0.64953097959654493),
            Complex::new(0.60677648762089920, 0.13745881812890565),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'c',
        'u',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.0579567752247829, 4.2318271008991317),
            Complex::new(-1.1232566087643057, 1.6229204428910589),
            Complex::new(-1.2837863590779532, 1.0956462503362694),
            Complex::new(0.47796290633027105, 0.96207423451653451),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(2.3150280007745794, 0.63685860791603754),
            Complex::new(2.2624427795069453, 6.2208238894031505),
            Complex::new(-0.26099622425819252, -0.43956352857782066),
            Complex::new(1.3334031780571216, 1.7106045501024205),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.0180848632672184, -0.97144175027114776),
            Complex::new(1.3005417206512548, -1.3335192952681145),
            Complex::new(-0.21050369340669117, 6.2852269046868234E-002),
            Complex::new(0.21906001894265437, -0.40454921133144506),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(9.1466090301429492E-002, 1.4457155942587572),
            Complex::new(-0.15080443493975754, -0.69841399511728985),
            Complex::new(-0.72806507098245399, -8.5344896367701872E-002),
            Complex::new(0.21357793530192870, 0.26739183168697100),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.7288259843431792, -1.0989849595005481),
            Complex::new(-0.18565033215892085, 9.4520609192656660E-002),
            Complex::new(1.2053632224825974, 0.90033491421473744),
            Complex::new(-4.5530510627187937E-002, -0.57592815422904708),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.54147678354977180, -1.2650404084853966),
            Complex::new(4.8542259658938658E-002, -2.1044146714297556),
            Complex::new(-1.9638490419892997E-002, -0.15713434073977314),
            Complex::new(-0.18212487372942077, -0.50651968429266925),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        't',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-1.9505989523860570, 1.9309139091119321),
            Complex::new(3.3379829105481416, 2.5125975662218010),
            Complex::new(3.3526092371972349E-002, -1.1612399353866310),
            Complex::new(0.34645774818088576, 0.28057501053159395),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(3.3379829105481416, 2.5125975662218010),
            Complex::new(4.2328018567093171, 1.2202965671813040),
            Complex::new(-0.11989825912852629, -0.88696985726543032),
            Complex::new(0.79851111695362287, 0.41539800883503269),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.12590742849348960, -1.1241088862647408),
            Complex::new(-0.38694005909781548, -0.90847091301716532),
            Complex::new(-0.11138852965241561, 6.7063414084841150E-002),
            Complex::new(1.2837599485019321E-002, -0.19049002371540902),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.55955982623885359, 3.7336090567630764E-002),
            Complex::new(8.6367840531936746E-002, 1.6945018096253788),
            Complex::new(0.18908997688474419, -0.31737142009093378),
            Complex::new(0.12676149970562242, 6.4043945950648065E-002),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.36435942015538830, 1.2077797836508710),
            Complex::new(0.36614546512502311, -2.6807521256975955),
            Complex::new(-0.66946095654461790, 0.30860680363026749),
            Complex::new(-0.11660175095677680, -0.20949314958488330),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.40919524539566920, -1.0517548546196733),
            Complex::new(-1.5046645317431810, -0.24893633540388876),
            Complex::new(4.8566345127667304E-002, 0.28994837960133141),
            Complex::new(-0.15617033770313232, -0.15971929721539610),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'c',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.0579567752247829, 4.2318271008991317),
            Complex::new(-1.1950330007958705, 2.3036558641742535),
            Complex::new(6.7725688637218090E-003, -0.41540938673411332),
            Complex::new(1.4304504498188167E-002, 0.44559027027128345),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(2.1385142309018876, 1.4702690562498142),
            Complex::new(1.8115834639122208, 7.2463338556488832),
            Complex::new(-1.5353200337527573, -0.37851150753656526),
            Complex::new(0.20793002706462263, 0.87575145645756003),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.12291575870348909, -0.21972553061175656),
            Complex::new(1.3705395242167671, -0.87168747195335228),
            Complex::new(9.4320977217824606E-002, 0.37728390887129842),
            Complex::new(0.15250700123398303, -0.11486020925565452),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-3.9572553580824898E-002, 1.1081444361838544),
            Complex::new(1.2108620932352083, 0.14618662908883401),
            Complex::new(-4.2047134634157643E-002, 0.13067400557469530),
            Complex::new(3.4445271869298473E-002, 0.13778108747719389),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(2.0272304521703273, -1.1250453175787349),
            Complex::new(-0.66087815065919209, -0.33308749895043088),
            Complex::new(0.12665179841918656, -0.24182867532492397),
            Complex::new(8.2235716768879530E-002, -0.22521242180814338),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.55146065751520323, -0.79145547530004379),
            Complex::new(0.86862262932433842, -1.9707865218826723),
            Complex::new(0.27211368096996741, 0.30464155746865007),
            Complex::new(1.8704063970759049E-002, -0.22259736357888021),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'c',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'c',
        'n',
        4,
        0,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(b, a);

    let mut b = mat.clone();
    complex::trmm(
        'l',
        'l',
        'c',
        'n',
        0,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(b, a);

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'x',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'l',
            'x',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'l',
            'u',
            'x',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'l',
            'u',
            'n',
            'x',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'l',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            3,
            &mut vec![],
            4,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trmm(
            'l',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut vec![],
            3,
        );
    });
    assert!(result.is_err());
}

#[test]
fn trsm() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'l',
        'u',
        'n',
        'n',
        0,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(b, a);

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'l',
        'u',
        'n',
        'n',
        4,
        0,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(b, a);

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'l',
        'u',
        'n',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'l',
        'u',
        'n',
        'n',
        4,
        6,
        Complex::new(0.2, 0.6),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-4.3361652432024105, 5.0817591262333144E-002),
            Complex::new(-2.0249635404714752, 1.7462050727369067),
            Complex::new(0.77158003384479212, -3.8415480814979444),
            Complex::new(0.21570408905600796, 1.9735891392210492),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-8.2139495894393040, 4.8677252138520410),
            Complex::new(-2.0039016266034926, 1.9845593475367109),
            Complex::new(-6.4454152206686262, -5.2771742255747300),
            Complex::new(1.2223454650802608, 3.8174245842806820),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(1.3857920232502359, 1.1657342725850861),
            Complex::new(0.54529105274886491, 0.44716783611311939),
            Complex::new(-0.28228804719577089, 1.9103995406836893),
            Complex::new(0.63791932476091384, -0.56208167491729433),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.20000000298023224, 0.60000002384185791),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.46993546772940703, 0.78297017799556667),
            Complex::new(1.2442533187414169, 0.70748691739496816),
            Complex::new(-0.30235439589226298, -0.45135362987370048),
            Complex::new(0.28821575391397702, -1.0280578753313314),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(3.0644786953144361, -1.0535611790318242),
            Complex::new(1.0022406100444330, -0.63771156883787317),
            Complex::new(0.85792295390476214, 2.2260221537764036),
            Complex::new(7.0206819964166410E-003, -0.99474760661160389),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ],
        1E-5
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let mut b = mat.clone();
    complex::trsm(
        'l',
        'u',
        'n',
        'u',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(3.1357042123101007, -0.48593408612451361),
            Complex::new(1.5076802903345801, -0.65299323707765800),
            Complex::new(1.4424603689891793, 0.38898484777779974),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-1.0903241741144321E-002, -5.0565088147146966),
            Complex::new(3.0358020761002358, -3.6179178067549391),
            Complex::new(-0.12527489724061169, -2.8922090420482398),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-2.1159829697342700, 0.89955289343691880),
            Complex::new(-1.1728210756763398, -0.60629526905397835),
            Complex::new(-0.62439769834025860, 0.43606883898065529),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.60259431373043126, 0.19430198654291148),
            Complex::new(-0.96368974491656223, -1.3678721751645730E-002),
            Complex::new(-0.24635347713030731, 0.34620704036331307),
            Complex::new(0.37739565968513489, -0.17262350022792816),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.75296106115355377, -0.91333951592953333),
            Complex::new(-9.1086915462928464E-003, 5.7624376681352174E-002),
            Complex::new(0.85920242744986552, -0.53944747954431049),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-1.8493189366425806, -0.38904525818272895),
            Complex::new(-1.6372872292772385, 0.67912994685483496),
            Complex::new(-0.53860198366790479, 0.66458617098718398),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'l',
        'n',
        'n',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.58206704082275329, -0.18591136302847366),
            Complex::new(0.28806021270856080, -6.1480539743304119),
            Complex::new(7.1273053520156848, -1.0683377591471988),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.62880887442171129, 0.13547227203129142),
            Complex::new(1.3408230860318302, -0.19575665942292952),
            Complex::new(-0.65175602235460295, -3.9049750709800799),
            Complex::new(4.3369827125323317, -1.6373325133299099),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.24188009916959066, 0.84882803045460142),
            Complex::new(0.33523339068246111, -0.76216414512317321),
            Complex::new(-3.9585769323813955, -2.9313047246339132),
            Complex::new(0.15295088136724475, -5.3139192718351618),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.19221290948158870, -0.19445162886640396),
            Complex::new(0.12525595232395595, -1.2672383707009358),
            Complex::new(-0.12450969245726197, -2.7096060848420587),
            Complex::new(2.6812148155230839, 6.9161957114693058),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.11002148798912938, 0.19760805055335301),
            Complex::new(-0.27947495342059742, 0.44740273115904228),
            Complex::new(-3.9928312766723866, 2.0068294154442317),
            Complex::new(-4.3769158322166435, -8.3308451200685276),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.66356096090001560, -0.60710000635792616),
            Complex::new(0.31367418621923127, -0.48814816511347880),
            Complex::new(3.2173115764366944, -4.6263877632965906),
            Complex::new(5.5336342188508736, 6.4226727706510829),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'l',
        'n',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(5.1639869809150696E-002, -0.37787322700023651),
            Complex::new(0.48686117026629383, 1.3421140072087849),
            Complex::new(0.74914063644201700, 2.1959189696717472),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.23789153993129730, -0.69067551195621490),
            Complex::new(0.48770744682920997, -0.89088078863640652),
            Complex::new(1.0835713226638233, 1.1906803067326432),
            Complex::new(2.0046754793261115, 5.0420310426421393),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.98985207080841064, -0.15780496597290039),
            Complex::new(-0.28620991205186996, -0.73503080754954908),
            Complex::new(1.6940324753771179, 1.0809248721181137),
            Complex::new(3.0475979083799656, 2.0756479979078910),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.24528039246797562, 0.19040291756391525),
            Complex::new(-0.74560179064123067, -0.32623164318062758),
            Complex::new(-0.13538034192478071, -1.2316202153710734),
            Complex::new(2.4585066717163002, -0.63922548185124539),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.20791782997548580, 0.15081105567514896),
            Complex::new(0.12472167807203721, 0.20617742099636954),
            Complex::new(1.2366470065183444, 0.27616290202981536),
            Complex::new(-0.17988283247608949, -0.43675772068299790),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.59469593316316605, -0.83040248602628708),
            Complex::new(9.6263683752580986E-002, -0.10394887225038407),
            Complex::new(-2.0381596972484126, 0.38710425384444547),
            Complex::new(-1.9873804651826856, 0.67471881850332560),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ],
        1E-5
    );
    let mut b = mat.clone();
    complex::trsm(
        'l',
        'u',
        't',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.38398920192561342, 0.19807783889713979),
            Complex::new(2.1623518366641039, -2.8514495652032292),
            Complex::new(1.3835248630505073, -2.8932506519951993),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.38214057322650141, -0.24666830119520999),
            Complex::new(1.0213420938507443, 0.39242684666128896),
            Complex::new(-0.60797340845888548, 0.14612637589888017),
            Complex::new(5.6825201168694779, 6.2951878938888370),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.54535406481209603, 0.30347396564250545),
            Complex::new(0.49397370175638877, -0.63613068005243234),
            Complex::new(1.8719258117215858, -0.72013420143310292),
            Complex::new(4.1735067269985384, -5.4728121981207432),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.19333226917399632, -1.1193596924076359E-003),
            Complex::new(0.64810480211333787, -0.44805523663770835),
            Complex::new(-7.9247902684516022E-002, -0.24587783876929911),
            Complex::new(2.1687405694259594, -0.62240370647012444),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-4.3793281282111809E-002, 0.15381476927124119),
            Complex::new(-0.44995544389580200, 1.7313769981318280E-002),
            Complex::new(-1.4727853010824283, -1.9391129513978369),
            Complex::new(-5.3054338206921674, -2.0641789602449854),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-2.8230477271044732E-002, -0.63533048362897082),
            Complex::new(0.81110859934416335, 5.5392721986944740E-002),
            Complex::new(0.27631589848386190, 2.2432587748416113),
            Complex::new(4.5434806476144285, 2.5580388858223335),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'u',
        'c',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(5.1639869809150696E-002, -0.37787322700023651),
            Complex::new(-2.5206088289136730E-002, 1.1629327100576257),
            Complex::new(0.20968760493191496, 0.28705110973472481),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.23789153993129730, -0.69067551195621490),
            Complex::new(-0.26496362306923205, -1.0970069132074767),
            Complex::new(0.55598041415056509, -1.8340719617223418),
            Complex::new(3.0059601094679920, -0.50795685485326569),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.98985207080841064, -0.15780496597290039),
            Complex::new(-1.0216620259901958, 4.3261524908377424E-002),
            Complex::new(-1.5732830857475251, -0.77647276535364917),
            Complex::new(-0.74275730651301819, -1.6198648887095417),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.24528039246797562, 0.19040291756391525),
            Complex::new(-0.42986920954526320, -0.42795572168039819),
            Complex::new(-0.51989924351798744, 0.59343464735270501),
            Complex::new(-0.72982011491647292, -0.81950525704073118),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.20791782997548580, 0.15081105567514896),
            Complex::new(0.13254591571963054, 0.48046129330801096),
            Complex::new(0.79669860642500856, 0.18158566971985768),
            Complex::new(-7.8444567809192706E-002, 0.70333648715206487),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.59469593316316605, -0.83040248602628708),
            Complex::new(-0.27819259697802301, -1.1288267484212382),
            Complex::new(0.69543869186319496, -0.81416188441863024),
            Complex::new(-6.4642539030115742E-002, -1.1821286829537094),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'l',
        'c',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-4.3307363060096407, -2.7946345411910478),
            Complex::new(0.11353332791702542, -3.0358071189164932),
            Complex::new(0.55208236183382731, 1.1961048753180581),
            Complex::new(0.77588781714439392, 0.49654152989387512),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-7.0311438643010415, 1.1171425552589795),
            Complex::new(-4.3062336946982169, -5.8321251417984232),
            Complex::new(1.5466374403877694, -0.96427463617099818),
            Complex::new(1.7351219654083252, 0.66953134536743164),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(4.1622765398091177E-002, 0.69521904772987897),
            Complex::new(-0.61253900315441545, 1.2181547686081091),
            Complex::new(-0.43829928629757298, -0.17216192477108372),
            Complex::new(-1.7404049634933472E-002, -0.39410677552223206),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.56549284412051548, -0.27538989181529694),
            Complex::new(-1.1394971980570936, -0.71775698460253956),
            Complex::new(-0.26951704658019660, 0.13552381773097144),
            Complex::new(0.27500957995653152, 0.10238607972860336),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.50287091838029463, 1.6264350851089353),
            Complex::new(0.54062240916135029, 0.65614164017279974),
            Complex::new(0.74291551890930574, 1.4887190977662890E-002),
            Complex::new(-0.28756426274776459, -0.40338958799839020),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(2.5860416002659656, -0.44334652705500277),
            Complex::new(-7.5655716285016883E-004, 1.6918377805927700),
            Complex::new(-0.59795894462510213, -7.8021761167668346E-002),
            Complex::new(-0.35737990960478783, -0.29209173098206520),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'l',
        'c',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(3.2114827761694884, -1.2846095423412685),
            Complex::new(1.5503648408551474, 4.4080590332372749),
            Complex::new(-2.9600976780577679, 0.68164714071945287),
            Complex::new(2.1978716763715078, 0.31038308221278982),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-3.7806964953253734, -11.234685472902157),
            Complex::new(-4.0624048931288526, 2.7647600951936040),
            Complex::new(-0.37132049362104180, 8.2950004471256946),
            Complex::new(4.4732081518896267, -0.27199439215993904),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-2.4119174862654607, 1.7225886543340081),
            Complex::new(0.51499044925440918, 0.96123297937376218),
            Complex::new(1.7893302398404849, -0.91785955565342003),
            Complex::new(-0.43315265585394902, -0.84615294251694417),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.78423006077463697, 1.0670162040634159),
            Complex::new(-0.75490610486826837, 3.3772776763820724),
            Complex::new(0.42956905016845520, -8.2012070905188875E-002),
            Complex::new(0.70524435153594800, -5.1287470464435207E-002),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.9108710108976654, -0.95994065844713927),
            Complex::new(3.3809090757975113, -4.0033212630382105),
            Complex::new(-1.0378465905588075, 0.19755007267142216),
            Complex::new(-1.0344527435182400, -0.59571097023070418),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.22005186087559850, 2.9083748042948385),
            Complex::new(0.29861845576296858, 0.26813155878356687),
            Complex::new(1.3335283313160229, -1.8440141707310576),
            Complex::new(-1.0758836637869365, -0.28184989512031339),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = mat.clone();
    complex::trsm(
        'l',
        'l',
        't',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-7.8076337836157279, 4.0993206753680189),
            Complex::new(-1.8295479518062130, -0.24446324023732294),
            Complex::new(4.4597950266431416, -4.4044872370943642),
            Complex::new(1.2024986277707916, 1.8657370162296123),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-4.6697143593159502, 4.0692195593982010),
            Complex::new(4.8582332712042673, -4.5558592861194951),
            Complex::new(1.9409323685427113, -4.6660804469995147),
            Complex::new(3.1310576644680514, 3.2062517089701701),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.30582815236225375, 0.58638190776618515),
            Complex::new(-1.3910001582447591, -0.62226772185487511),
            Complex::new(-0.77190259491118007, 0.13110199345193430),
            Complex::new(0.35687846744323848, -0.88104130713535689),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-2.2249105593392784, -0.42411014448576401),
            Complex::new(-0.17300353837081367, -2.4219792218885750),
            Complex::new(1.7345530403869818, -0.43268236926825521),
            Complex::new(0.50000000000000000, 0.50000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(4.0526164462653291, 3.8090707449523515),
            Complex::new(-0.17682746073495273, 4.2513853938671522),
            Complex::new(-3.3623697809536544, -1.3367942438768332),
            Complex::new(-0.22581318407280718, -1.1721657069393052),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(1.6810227004728377, -2.2963693741212503),
            Complex::new(-0.87168363627809720, -0.35249705550733018),
            Complex::new(-0.83090224578331329, 1.5601685284262006),
            Complex::new(-0.49035311047990943, -0.99825790676839188),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[6] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'u',
        'n',
        'n',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.0000000000000000, 0.0000000000000000),
            Complex::new(-0.32494072389639828, -8.4816837991899430E-002),
            Complex::new(1.1274062950571064, 9.4806507526275507E-002),
            Complex::new(0.51556383273975637, -0.62620503057994281),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.83475377304772769, -0.82032757162082492),
            Complex::new(1.0000000000000000, 0.0000000000000000),
            Complex::new(1.2479358164593708, 0.43510358886114614),
            Complex::new(0.22834580111255753, 2.9709409537969433),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.87796857814747720, -0.62152745097636719),
            Complex::new(1.1146758180687049, 0.41318613334001636),
            Complex::new(-2.7473118247562103, -1.9306755011161216),
            Complex::new(0.75640273122785939, 2.7196786275350715),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(1.3630350271734757, -1.5508708531377995),
            Complex::new(2.0066569270578576, -0.61198094792614466),
            Complex::new(-4.0577627131866096, 3.7895436736523278),
            Complex::new(2.8146419688672890, 11.595788905412597),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.0215582491333848, 1.1481598504011052),
            Complex::new(-7.7769868288677713E-002, -0.35638124094632623),
            Complex::new(-1.2102887081426890, 0.67798051594131403),
            Complex::new(0.61336494161218291, -3.7104175813872953),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.46341499618686954, -2.4588520639821949),
            Complex::new(1.4497081868206336, -1.0608250567603350),
            Complex::new(-1.4813720986519567, 3.5945913575323409),
            Complex::new(6.2817206419285796, 10.059758391332867),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ],
        1E-5
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'u',
        'n',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.13539692759513855, 1.1275573074817657),
            Complex::new(5.1639869809150696E-002, -0.37787322700023651),
            Complex::new(4.5747578144073486E-002, 1.2840517163276672),
            Complex::new(0.77588781714439392, 0.49654152989387512),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.23789153993129730, -0.69067551195621490),
            Complex::new(0.26866142451763153, -0.56338186562061310),
            Complex::new(0.58040168578736484, -0.58616885845549405),
            Complex::new(1.7351219654083252, 0.66953134536743164),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.19186785532622430, 0.76958389212650768),
            Complex::new(-8.0369890545353151E-002, -0.83703376502211491),
            Complex::new(1.1394747963304193, 1.3813165626456412),
            Complex::new(1.6362424742181005, 0.11842399616672594),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.17606616332521496, -1.0346838035300410),
            Complex::new(-1.0895629141983747, -1.2286733396003198),
            Complex::new(1.1695290809520620, -1.6252183324559464),
            Complex::new(2.6646483567786019, -0.66186213887078860),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.35900195330351203, -0.83780264788906567),
            Complex::new(0.25973652880524911, 0.35093876065416163),
            Complex::new(-0.34958126066018347, -0.98434771503567731),
            Complex::new(-0.91651662399387646, 0.29048335462677405),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.79619965537780191, -0.44151694564207233),
            Complex::new(-1.1767017099032087, -1.8377205595222044),
            Complex::new(-0.33383555601404047, -0.34955041709655676),
            Complex::new(3.4023321229178332, -0.49334048025955746),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ],
        1E-5
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[22] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'l',
        'n',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-5.0591574827047339, -4.9698820795136882),
            Complex::new(2.9311310560265698, 0.84183569622397436),
            Complex::new(-0.48324654918678833, 5.0127353391474108),
            Complex::new(2.2077061131604707, -0.69854605095628619),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(7.4161663224215681, -7.1604166788591357),
            Complex::new(-4.0041878720215562, 0.84537171799125921),
            Complex::new(-2.0220733066282830, 4.2572003879524152),
            Complex::new(1.6417092873163666, -4.7544762316563363),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(4.4918339382111698, 1.1490814311823123),
            Complex::new(-2.4164503859434818, 0.98547691417323224),
            Complex::new(0.67386215211886902, -2.3548308010299550),
            Complex::new(-2.1370493475834982, 0.36264306554656278),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.88529870121310128, 3.7394932406460706),
            Complex::new(3.1207145954188054E-002, -2.6296541405864176),
            Complex::new(-0.18872533273522937, -0.53649824117162492),
            Complex::new(1.9029010959059771, 0.34560534292325140),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.19393416590299054, -0.20559819740708857),
            Complex::new(-0.27444364722333936, -9.1157251762485556E-002),
            Complex::new(-0.61959923233711700, 0.27973439611890816),
            Complex::new(0.28349760785116063, 6.1876683765610271E-002),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.33833521252830906, -0.79647519117257892),
            Complex::new(-0.39207809681367967, 1.0784825381357291E-002),
            Complex::new(-0.29892032609917235, -1.3477740218522716E-002),
            Complex::new(-0.34945678427345950, -0.17550224014507099),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'l',
        'n',
        'u',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-6.6958272002905428, -9.8408017913905148),
            Complex::new(1.0820954135679002, 7.4450156507721026),
            Complex::new(2.2676559308021567, 8.9629948135133084),
            Complex::new(0.12503837766758608, 3.1427388339321043),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-11.578342149986291, 0.42985376004126707),
            Complex::new(5.9537185291639814, -4.5607573260779799E-002),
            Complex::new(3.9950587748781672, -1.7241165222288140),
            Complex::new(0.83442619010886920, 2.0238907563301982),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(1.7515003499232142, 1.4475852329073575),
            Complex::new(-1.2129598730224560, -2.6430256456877874),
            Complex::new(-3.2753762601352809, -2.6149090240568058),
            Complex::new(-5.5927101748459718E-002, 0.60692074122709005),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(2.4260109525592837, 0.79332951665253049),
            Complex::new(-1.2633618939958353, -0.73014616027439949),
            Complex::new(-0.18970207664069960, -0.12906475111063909),
            Complex::new(0.81719485195650599, -1.0458092960671421),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.39134241345283100, 0.48242136796994939),
            Complex::new(0.61762925281416070, 0.10337749901712778),
            Complex::new(1.1661976616820193, -0.84728125503688667),
            Complex::new(-0.64478958643301165, 3.8467268628461532E-002),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[30] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'u',
        't',
        'n',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(7.8548948451689302, -1.4517329494138931),
            Complex::new(0.17654671858140780, -9.4387634793868180),
            Complex::new(-1.6866026558673723, -5.6817406388088747),
            Complex::new(1.4772503634364491, 0.86432401936451209),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(3.0601942738874301, -0.52640142985026428),
            Complex::new(-0.10377240436541091, -4.5596165286812198),
            Complex::new(-1.9464271308776548, -2.8867679752665496),
            Complex::new(-1.0092313646782454, 2.8010376913028976),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(3.1451904940166528, 4.5341755230345697),
            Complex::new(6.1746224388481341, -1.5523978802792286),
            Complex::new(2.8268587038181350, -2.6457341517658168),
            Complex::new(0.85916438643265958, 1.3806202192454864),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.66157852149969598, -2.9363489396777793),
            Complex::new(-4.6190308173430674, 1.6665280458734388E-002),
            Complex::new(-3.2210325377066784, 2.6195232296555249),
            Complex::new(0.46205850474058635, 0.25996805243186816),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.56086837139946488, -0.57227130068735377),
            Complex::new(-0.33320568373813664, 0.44221914298914511),
            Complex::new(-0.32953615350602994, 1.0981416447601218),
            Complex::new(0.25166817252864804, 2.1087441370453971E-002),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.45813997864426981, -1.1348104037008879),
            Complex::new(-0.38129327143232239, 0.40286292219503700),
            Complex::new(-0.31239806631769507, 0.28544258588064964),
            Complex::new(-0.52495902441853048, 0.17395454412838854),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'u',
        'c',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-3.0948252942705481, -1.9275733244214712),
            Complex::new(-2.2771057201456189, 6.7125960840252308),
            Complex::new(1.1694157169980317, 4.6294937060395656),
            Complex::new(-0.99372825711811785, -0.70202448069359713),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-3.3124587735883360, -2.2114675151228083),
            Complex::new(-2.0844789793040022, 2.8327856044464470),
            Complex::new(-0.66765113059000436, 2.5580150700359718),
            Complex::new(-0.42212007137943308, -3.0184137084415688),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.84428411895238664, -4.6540299328827861E-002),
            Complex::new(4.5701707231640540, 2.8788197410972991),
            Complex::new(2.8557874451127794, -1.1026660085131712),
            Complex::new(0.44752797709352565, 1.5446757675856397),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(2.1148935369493174, -1.6827616463576003),
            Complex::new(-3.3297218991252682, -0.76255350465697669),
            Complex::new(-2.5363952950995974, 0.63347645132551478),
            Complex::new(0.31328580158181496, -0.18523871996536231),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.57456590107976302, -8.8809162578436129E-002),
            Complex::new(-0.16497185113755669, -0.37989437108374974),
            Complex::new(-0.61122985871044555, -0.51917723027390406),
            Complex::new(-6.0673355220776104E-003, 0.13978852736700292),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.64511978367810352, -0.57677024099470420),
            Complex::new(-0.35939234778477547, -0.15709451554172907),
            Complex::new(-0.26476595202960435, -0.13940588754600997),
            Complex::new(-0.24154617714782373, -0.30753296518577905),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ],
        1E-5
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'u',
        'c',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.4663099214223421, -0.54047488085955897),
            Complex::new(-1.0204397181828506, -3.5613197699753938),
            Complex::new(-1.7781817782592808, -1.5049934545330819),
            Complex::new(2.5922105922742009, -0.63377311418065152),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(1.2094864316776728, -1.1285628157472671),
            Complex::new(-1.3817072381689259, -2.0415375192838203),
            Complex::new(-0.67901643050722904, -0.71060499057503734),
            Complex::new(1.6230565715427296, 8.7107442658439282E-002),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.76899320603609500, -0.33665447309721686),
            Complex::new(-0.42206523221567682, -1.7558900195297258),
            Complex::new(-1.6341374336066268, -1.3047464365950561),
            Complex::new(-0.10506998091690464, -0.41386835171297720),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.34312377243436221, 0.29126813394857332),
            Complex::new(-0.59107151240193612, -0.44049830808773233),
            Complex::new(0.25129888652231969, 6.0485041120495686E-002),
            Complex::new(2.3674373162191606E-002, -0.24485534476133647),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.62420601985847957, 0.76569889751124731),
            Complex::new(0.58926779084209124, 0.30187454338941599),
            Complex::new(1.2627016079606279, 0.13321771628270229),
            Complex::new(-2.2242728681991536E-002, -0.19795781806420257),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.59469593316316605, -0.83040248602628708),
            Complex::new(-0.45441471040248871, -8.8473573327064514E-002),
            Complex::new(-0.34086149185895920, -9.2448838055133820E-002),
            Complex::new(-0.35737990960478783, -0.29209173098206520),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'l',
        'c',
        'u',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(0.13539692759513855, 1.1275573074817657),
            Complex::new(5.1639869809150696E-002, -0.37787322700023651),
            Complex::new(4.5747578144073486E-002, 1.2840517163276672),
            Complex::new(0.77588781714439392, 0.49654152989387512),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.29058008527797075, -0.38098345978096138),
            Complex::new(0.12320657268015323, -0.70883671745809140),
            Complex::new(1.1468431009319726, -0.18691754019113382),
            Complex::new(2.2015135429981934, 0.49826577653114423),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-3.0089299459903742, -1.8307466678253201),
            Complex::new(-0.45801261091796641, 0.16022913745305389),
            Complex::new(-2.1449963403544028, -3.0063718905692967),
            Complex::new(-1.0700898658711426, -2.6589695241604399),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-2.6445949545316561, -0.29556295457399617),
            Complex::new(-2.0948227033757609, 1.7843824252885900),
            Complex::new(-5.0929063998055071, -2.6513787852201860),
            Complex::new(-6.7784699393746495, -4.9813269200045633),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.8599051788280123, -1.2056064376526816),
            Complex::new(3.6695818046973789, 4.1045003937456315),
            Complex::new(0.23231737855285939, 5.1710761103511471),
            Complex::new(-5.7967759216873223, 10.728507916547569),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-1.3376217103528405, 5.8601555037057000),
            Complex::new(3.2477332712224189, 1.3511749795408745),
            Complex::new(-4.6804535705120376, 10.494488399442380),
            Complex::new(-4.4990031361706428, 12.997031650006122),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[1] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'l',
        'c',
        'n',
        4,
        6,
        Complex::new(0.5, 0.5),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(-0.36741276127057476, 0.60415880599022287),
            Complex::new(0.17063020818508723, -0.16515301111800390),
            Complex::new(-0.47150164632793762, 0.64629932037091398),
            Complex::new(0.18890255218209451, 0.54155814900669563),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.64757290251688482, 0.51529111103843594),
            Complex::new(-0.70324555223933194, -7.3794940582651680E-002),
            Complex::new(-0.84549686891790510, -0.39807601305655405),
            Complex::new(5.8657242155078837E-002, -2.1061517765487783),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(2.3082564821560467, 0.14524375748609208),
            Complex::new(-1.3792008298882079, -2.0902032907923536),
            Complex::new(2.5161092036627539, -0.64775118484682082),
            Complex::new(7.9311523789414942, -3.8428875310141279),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(6.9097522767873212, -8.0215620624606707),
            Complex::new(-1.3869903805179185, 1.3101362478412506),
            Complex::new(6.1974770189667181, -2.4369489382605147),
            Complex::new(-1.0468654795781644, -6.8311197539077717E-002),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(7.7241551063563616, 11.769974991681147),
            Complex::new(-4.5958984169367794, -4.3485959244870882),
            Complex::new(0.58181540692556810, 5.4677098013019378),
            Complex::new(6.9066837856439438, -14.215521507415600),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-14.436677303579794, -5.9238710367422076),
            Complex::new(0.85968153557106275, -1.6292481173854849),
            Complex::new(-6.0115478281876165, -9.3491345312296463),
            Complex::new(9.5649470740342544, -3.9291421855988817),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ],
        1E-5
    );

    let mut b = fixtures::complex::matrix_mxn(6, 6);
    complex::trsm(
        'r',
        'l',
        't',
        'n',
        4,
        6,
        Complex::new(1.0, 0.0),
        &a,
        6,
        &mut b,
        6,
    );
    capproximately!(
        b,
        vec![
            Complex::new(1.0000000000000000, 0.0000000000000000),
            Complex::new(-0.32494072389639828, -8.4816837991899430E-002),
            Complex::new(1.1274062950571064, 9.4806507526275507E-002),
            Complex::new(0.51556383273975637, -0.62620503057994281),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.83475377304772769, -0.82032757162082492),
            Complex::new(1.0000000000000000, 0.0000000000000000),
            Complex::new(1.2479358164593708, 0.43510358886114614),
            Complex::new(0.22834580111255753, 2.9709409537969433),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(3.7621707201759254, 1.4653104669297830),
            Complex::new(2.3328393080681247, -2.7857917253735196),
            Complex::new(4.4060928625210982, 3.2428830175566885),
            Complex::new(10.126242761498597, 8.6688692872683824),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-7.2522521682739480, 10.214425752174813),
            Complex::new(-3.6877018325740307, 1.1359533616370237),
            Complex::new(-14.088127853858264, 4.3942942803299658),
            Complex::new(-7.6444600158468443, -0.18616402987895375),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(19.852281413416609, 8.0438098273014909),
            Complex::new(9.3221529952824742, 2.7937363849823331),
            Complex::new(16.862486159632002, 24.203264055511880),
            Complex::new(9.0583736349190165, 30.496466499458052),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-6.3893276455354862, -17.559573741599259),
            Complex::new(3.0523282342701270, -8.7820118084014993),
            Complex::new(8.4826504626643384, -20.549739325639941),
            Complex::new(16.285707335606293, -0.53219856882880379),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ],
        1E-5
    );
    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'x',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'l',
            'x',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'l',
            'u',
            'x',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'l',
            'u',
            'n',
            'x',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'l',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            3,
            &mut vec![],
            4,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::trsm(
            'l',
            'u',
            'n',
            'n',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &mut vec![],
            3,
        );
    });
    assert!(result.is_err());
}

#[test]
fn hemm() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        0,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.7, -0.3),
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        0,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.7, -0.3),
        &mut c,
        6,
    );
    capproximately!(c, b);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.4146414344564082, 1.7579030898107073),
            Complex::new(-1.5399500419037095, 0.5607460908880562),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.7635934611404596, -1.563782051071005),
            Complex::new(-0.7990092489893682, 1.1565369971501793),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.2522234481561323, 2.4413646288945894),
            Complex::new(-0.8919211272845686, -0.7953391172553718),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.1333363608148414, -2.2239002740099374),
            Complex::new(0.8041895097449078, -1.263614384970583),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(-1.2845993538721883, -0.8149687088699175),
            Complex::new(0.04672617218835198, 0.24226348085968588),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.726750747385451, 0.01915639166027384),
            Complex::new(1.1519117540872, 0.2573383771555333)
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(-0.1, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-0.62237560749053955, 0.53226113319396973),
            Complex::new(0.24737988460992777, -0.12016536827457980),
            Complex::new(-0.75213200052052631, 0.54106923157229403),
            Complex::new(1.2430207025365014E-002, 0.66414930266044481),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.31924869258488275, -0.41900512806656365),
            Complex::new(0.44549368961858815, -6.4155890297825202E-002),
            Complex::new(0.58386198939683609, 0.11377346982854686),
            Complex::new(0.29232997535965843, 1.3088857189798215),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.30125784702948177, -0.65703323011405335),
            Complex::new(0.14261050267437336, -0.12199792232017415),
            Complex::new(-0.10314716950175895, -0.17622129062732661),
            Complex::new(0.22950244607256476, -0.16808513942852210),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-1.6129594200377628E-002, 0.22332940258812528),
            Complex::new(-1.3168137706243144E-003, -0.64378336109242040),
            Complex::new(-0.28669484969337600, -0.17395827117300522),
            Complex::new(4.8572183583087236E-002, 0.20596018012258932),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.17365376531018797, -6.4426276249779590E-002),
            Complex::new(-4.4838060444009287E-002, 0.25290854202366692),
            Complex::new(0.36174763279293565, 0.63694962403274946),
            Complex::new(0.12700804872952975, -0.33389439267542165),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(0.73611986523226880, 2.4656567610946922E-002),
            Complex::new(-0.12868173935579019, -0.30803825611761382),
            Complex::new(-8.0875293264820680E-002, -0.24149643070759275),
            Complex::new(3.2303075715112151E-002, -0.33126463825298574),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(-0.4, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-2.9350657340050365E-002, 0.74442972472321212),
            Complex::new(-0.45724841254510279, 2.4720085014727919),
            Complex::new(-2.6679770806555987, 0.59139047225236530),
            Complex::new(-9.3815933352068392E-002, -0.66186967364671800),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(1.5935559894779265, -0.62128381917021469),
            Complex::new(2.1737031164892846, 2.1413157835605925),
            Complex::new(3.6351520910646191, 0.30419926268301800),
            Complex::new(0.13840214848770671, 1.8006383908576788),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.32836568409053613, 0.32203405755460113),
            Complex::new(-0.16239848402013413, -1.4478841158354525),
            Complex::new(0.29888586547997031, -2.3536534270582283),
            Complex::new(0.82847839806672074, 0.20658982019875485),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.39135653961213285, -1.2753244343960868),
            Complex::new(0.60691671473854047, -0.46120495921820964),
            Complex::new(-0.70341197232683361, -0.34856996829018666),
            Complex::new(0.35560598553536038, -1.6447638016528807),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.3449207395328406, 1.3215570006272412),
            Complex::new(-0.46409757273693786, 0.10578712406097923),
            Complex::new(-0.23249122621298632, 0.74794125234075148),
            Complex::new(-0.38751770034385613, 1.0133232474993610),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-1.0967932443017383, -0.34955354858902032),
            Complex::new(1.1465268689873731, -1.8341626752337215),
            Complex::new(0.81729097243390925, 0.39141011200385634),
            Complex::new(-0.19520613456232078, -1.0893009966163467),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'u',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.97191123416181879, 0.50981676505314755),
            Complex::new(-0.80249830577073311, 2.4633199387844824),
            Complex::new(-1.5169052858488845, 0.42181248767080021),
            Complex::new(0.27548266942224975, -1.4098228637310937),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.99573717717577193, -0.33811388473522830),
            Complex::new(1.6397932932222989, 1.9558586830974209),
            Complex::new(3.0495599498415631, -0.15954537563336316),
            Complex::new(0.56746817711041331, 0.17207548110202797),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.28532641495519784, 1.2286814228388478),
            Complex::new(-0.39184746285822969, -1.3940848009033966),
            Complex::new(0.31226850119727223, -2.0975909267832287),
            Complex::new(0.47552270260740953, 0.26166414017709494),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.24452195045453179, -1.5151170797007516),
            Complex::new(0.23697198590189406, 0.25762079977625840),
            Complex::new(-0.48399748916268936, 1.0861288768453325E-002),
            Complex::new(0.42025250154490373, -1.9025110326155357),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.5014424722976405, 1.4936019441758543),
            Complex::new(-0.26817711353436224, -0.15043506149737251),
            Complex::new(-0.26850802968163445, -0.17120312143764616),
            Complex::new(-0.72181190738603673, 1.3124700420818154),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-1.9036250764466338, -0.80173964832748956),
            Complex::new(1.1123421207973976, -1.4163420763575960),
            Complex::new(0.76817316478745390, 0.70743033996308791),
            Complex::new(-0.42235070535685332, -0.73844990448468328),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'l',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.6, 0.4),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.7403184111072991, -4.1567812522220677),
            Complex::new(1.5701776230823246, -1.7028121207367017),
            Complex::new(2.9217292794908212, 2.6645885235228102),
            Complex::new(0.37030167414141746, -0.67010759673956355),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-2.2630835590522227, -2.1229320066196156),
            Complex::new(2.4842119823959798, -7.2380204875169287),
            Complex::new(0.24931288619950953, 1.1393326242309958),
            Complex::new(-0.15626431993015122, 1.8841563199065459),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.46557598774341352, 1.6616017947432198),
            Complex::new(-1.2238551365692814, -0.46964373631685929),
            Complex::new(-0.81409954211000601, 1.9643136086659696),
            Complex::new(0.28587285557125508, 1.4882791703898399),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.89436110606475971, -1.2718653038804530),
            Complex::new(-1.1453435725176404, -0.90558360620368383),
            Complex::new(1.3523464275293064, -6.9845612710061400E-002),
            Complex::new(1.1498371510409668, 1.7082210529850559),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-2.1478995758838577, 0.37940110303243435),
            Complex::new(0.35644753206828794, 0.56659829235487935),
            Complex::new(0.83133135676970071, 0.27374976655088035),
            Complex::new(-0.46041159244318619, -0.50905345399265156),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.95665587081220771, -0.11330529120488797),
            Complex::new(-1.3978267600056178, 1.7207265051741496),
            Complex::new(-1.4299226926401771, -2.2074907397804298),
            Complex::new(-0.89586074955465600, 1.0081050580370876),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'l',
        'l',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.3794099978183687, -5.2572592053675464),
            Complex::new(1.5941124038911330, -1.3146109075897425),
            Complex::new(2.6191713337571962, 1.3896862853742649),
            Complex::new(-0.50489448098386491, -1.0114715641286953),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-1.8870568972897215, -1.4798347863197581),
            Complex::new(2.3282269330697893, -6.6209063153986607),
            Complex::new(-0.21385503471255873, 1.8415818476915469),
            Complex::new(-2.0252926180947801, 1.5616493786935888),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.55583710858124047, 1.6214363335574582),
            Complex::new(-1.1411096564460139, -0.21746188326819893),
            Complex::new(-0.52811552388554139, 1.9243172304508096),
            Complex::new(0.38209826787649442, 1.8789051474191738),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.61100011936940624, -1.4132121442392671),
            Complex::new(-0.30276393832627546, -0.56065301559214753),
            Complex::new(1.7342044784438015, -0.35108443832156466),
            Complex::new(0.85435034511198460, 1.6608368911139704),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.9701439535436795, 0.18700647314980803),
            Complex::new(4.9864535667231709E-002, 0.37178238124408441),
            Complex::new(-0.19638998438563049, 0.40383150762655817),
            Complex::new(-9.2169396312492768E-002, -0.16317671166391745),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-1.3852713096446827, 0.83603641683594687),
            Complex::new(-0.92571731981307137, 1.7183171309318661),
            Complex::new(-1.0705714213586131, -2.1832142034369761),
            Complex::new(-0.48006247787969669, 1.2287208094127564),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'r',
        'u',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.1, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.0492507380581135, -4.6850680675356742),
            Complex::new(-0.25775830863319293, 0.19202397956818207),
            Complex::new(1.3794382927760527, -0.44054241540702310),
            Complex::new(1.7237475261652158, 0.76227571044567122),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.81369106407956837, 0.34668457065587932),
            Complex::new(1.5414087275787951, -2.1579996421612142),
            Complex::new(-1.4436299452257024, -1.1949543586973261),
            Complex::new(0.52941132056679197, 2.9833438731343485),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.43239486946219902, 1.7003452332800477),
            Complex::new(1.8862347506739041, -1.4426502124799074),
            Complex::new(-0.20421421491147029, -0.14624259107327331),
            Complex::new(-3.5154489111501430E-002, 1.9023132526066009),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.80601718477197659, -1.1614707583064985),
            Complex::new(0.27976830683464970, -0.61066513425175373),
            Complex::new(1.7846243759415663, 0.12124436054600474),
            Complex::new(1.1617834020943869, 1.0987454093262699),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.8790441320046147E-002, 1.5761153832527943),
            Complex::new(-0.25422556413653397, 0.73709976707440150),
            Complex::new(1.2693742279114388, 2.3969554131871549),
            Complex::new(0.23838117192449293, -0.77212650684833373),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-2.2885058185422174, -2.2605005049474509),
            Complex::new(0.78383108046051031, -0.52310022989716165),
            Complex::new(-1.7265234423765672, -2.5859374695898527),
            Complex::new(-0.75308659307088432, 1.9179323367452152),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::hemm(
        'r',
        'l',
        4,
        6,
        Complex::new(0.2, -0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.7620838935196597, 0.52572550560245579),
            Complex::new(-0.38722128429009905, 1.1122493341536011),
            Complex::new(3.5326335051329956, -1.6429894187198397),
            Complex::new(-2.9614312869456008, -2.0975914928727786),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(2.6066196946963776, -2.5408032465493644),
            Complex::new(0.18710810744380824, 1.9314235066316638),
            Complex::new(-0.64836486108789093, 0.78587559107639837),
            Complex::new(0.44782360205957850, 0.94720972056341235),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.10947565424998740, -1.4785510653310989),
            Complex::new(1.3309259797098396, -1.0493629461557186),
            Complex::new(3.4759585804621675, -6.1280154572816539),
            Complex::new(0.36200306504389429, -2.6446968059067788),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-1.8049380120023990, 0.65158667891350619),
            Complex::new(-2.4740051538807633, -0.35407474560864172),
            Complex::new(-2.0103238075393381, -0.95470719060530307),
            Complex::new(3.5191883793917236, -6.1574489307043727),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.74505125745013312, -3.7206741947987183),
            Complex::new(-2.6813185514918385, 0.96547808598946283),
            Complex::new(-0.53371050520175256, -2.0393952416895602),
            Complex::new(2.6098071711445425, -2.5701179676264876),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-2.9630782063318857, -0.25120108400440200),
            Complex::new(0.21875545102578733, 1.7054655666082565),
            Complex::new(-2.4531243858344594, 3.0252959544891533),
            Complex::new(-2.2812439006104843, 3.5862454770076102),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::hemm(
            'x',
            'u',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.7, -0.3),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::hemm(
            'l',
            'x',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.7, -0.3),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::hemm(
            'l',
            'u',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            3,
            &b,
            6,
            Complex::new(0.7, -0.3),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::hemm(
            'l',
            'u',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            3,
            Complex::new(0.7, -0.3),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::hemm(
            'l',
            'u',
            4,
            6,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.7, -0.3),
            &mut vec![],
            3,
        );
    });
    assert!(result.is_err());
}

#[test]
fn her2k() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'n',
        5,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.3,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.6058251087158846, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.68811782065567806, -0.10513209829930731),
            Complex::new(1.3043790631628438, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.94510615058316949, 4.4049789862753264E-002),
            Complex::new(0.45247300577452620, 0.24615098347899378),
            Complex::new(2.9377338070895544, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.11876585523864702, -0.21516651831640768),
            Complex::new(-0.52841648521717810, -1.2143434542327047),
            Complex::new(0.75802713251390341, 8.5800406111208816E-002),
            Complex::new(4.1193519035669652, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(1.4913513120355024, -0.36110486844967427),
            Complex::new(-0.72451401403152893, -0.83104674841077619),
            Complex::new(1.4374079607512258, -0.30645319423219780),
            Complex::new(1.1771392414997601, 0.75146076754272340),
            Complex::new(7.6629930339836436, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.3078002746096349, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.10361333547409496, 0.24149736125040472),
            Complex::new(1.1198417497625819, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.77267953344847207, -2.8878492069004986),
            Complex::new(0.18597724644402142, 0.13914165833399261),
            Complex::new(2.1022252342348491, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.99111221896503643, -1.8602335211692160),
            Complex::new(-0.16907159032896391, -1.2348811617422517),
            Complex::new(0.96275725625355313, -0.35673571528200110),
            Complex::new(3.6393697204873954, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.22504670092250856, -1.3057917981450853),
            Complex::new(-0.46540957116130088, -1.1081177222021112),
            Complex::new(1.4870086981201611, -0.93708248306429187),
            Complex::new(1.1799295830137679, 0.92797911610027761),
            Complex::new(6.9112116413057718, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.3078002746096349, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.24643398659643961, -1.0995645425482090),
            Complex::new(1.1198417497625819, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(1.1639551912088129, 1.7650659902905894),
            Complex::new(0.18597724644402142, 0.13914165833399261),
            Complex::new(2.1022252342348491, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-1.5932967169415519, 0.26754845325677068),
            Complex::new(-0.16907159032896391, -1.2348811617422517),
            Complex::new(0.96275725625355313, -0.35673571528200110),
            Complex::new(3.6393697204873954, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(2.6689699106340283, 2.3226802065569081),
            Complex::new(-0.46540957116130088, -1.1081177222021112),
            Complex::new(1.4870086981201611, -0.93708248306429187),
            Complex::new(1.1799295830137679, 0.92797911610027761),
            Complex::new(6.9112116413057718, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let a = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.3078002746096349, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(9.6222412413654423E-002, -0.47278950590771907),
            Complex::new(1.1198417497625819, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.38670296267975646, -0.51248215108491224),
            Complex::new(0.18597724644402142, 0.13914165833399261),
            Complex::new(2.1022252342348491, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.56706499579150604, -1.1193936509445461),
            Complex::new(-0.16907159032896391, -1.2348811617422517),
            Complex::new(0.96275725625355313, -0.35673571528200110),
            Complex::new(3.6393697204873954, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.76840260426801055, 0.87019628065047827),
            Complex::new(-0.46540957116130088, -1.1081177222021112),
            Complex::new(1.4870086981201611, -0.93708248306429187),
            Complex::new(1.1799295830137679, 0.92797911610027761),
            Complex::new(6.9112116413057718, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        1.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.5707545096865392, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.83234463947385784, -0.92557347793263667),
            Complex::new(0.82512130865960043, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.76095407410155458, 0.31956495375059812),
            Complex::new(-0.10348433645507227, -8.8187029572272702E-002),
            Complex::new(1.8030101260786449, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.13138168575961512, -1.1742711258486065),
            Complex::new(-1.4066100472457730, -0.98473983912948915),
            Complex::new(0.73848937116463265, 0.26150756179090506),
            Complex::new(4.0167653801725303, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.71129582996767371, 1.2289251663011131),
            Complex::new(3.8198417196242840E-002, -1.1191632004864702),
            Complex::new(2.5727781130218945, -1.8777316348663549),
            Complex::new(0.48897573226761326, 0.81215379084965211),
            Complex::new(5.6266123371065531, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        1.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.5707545096865392, 0.0000000000000000),
            Complex::new(-0.23001094477743128, 4.3276409098331858E-002),
            Complex::new(1.7165022571514967, 1.7507862892685062),
            Complex::new(0.70536435124676267, 0.84004736369402755),
            Complex::new(1.1830440441827141, 0.88770681840957999),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(0.82512130865960043, 0.0000000000000000),
            Complex::new(0.18021007377589254, -1.3057122025768517),
            Complex::new(2.2355817204467927, 0.16929054170135827),
            Complex::new(0.29818386412617515, -0.45566437370700763),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.8030101260786449, 0.0000000000000000),
            Complex::new(0.55124643109638771, -1.9967010605297639E-002),
            Complex::new(1.7392321599865397, 3.3784470098129495),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(4.0167653801725303, 0.0000000000000000),
            Complex::new(1.3132659482366984, -3.1518794342460295),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(5.6266123371065531, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ],
        1e-5
    );
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        1.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.6025287727873598, 0.0000000000000000),
            Complex::new(-0.56527642072708484, -4.4235421419301812E-002),
            Complex::new(2.8797310564492693, 1.8486052037085914),
            Complex::new(1.2373098448532591, 0.19394512971738070),
            Complex::new(2.0901620453582117, 1.6112109712987144),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(0.82512130865960043, 0.0000000000000000),
            Complex::new(0.18021007377589254, -1.3057122025768517),
            Complex::new(2.2355817204467927, 0.16929054170135827),
            Complex::new(0.29818386412617515, -0.45566437370700763),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.8030101260786449, 0.0000000000000000),
            Complex::new(0.55124643109638771, -1.9967010605297639E-002),
            Complex::new(1.7392321599865397, 3.3784470098129495),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(4.0167653801725303, 0.0000000000000000),
            Complex::new(1.3132659482366984, -3.1518794342460295),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(5.6266123371065531, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.5,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.9710516552489077, 0.0000000000000000),
            Complex::new(-0.40215974213154188, 0.17052112698539179),
            Complex::new(2.2148314092133989, 1.2294531346167945),
            Complex::new(0.60109517133412482, 0.33361827334264010),
            Complex::new(1.8828413254008600, 0.73225942176868508),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(0.97248152921109121, 0.0000000000000000),
            Complex::new(0.18309366010995715, -0.72242693045542217),
            Complex::new(1.0332550650589145, 0.70208585172180493),
            Complex::new(-8.3612853517562424E-002, 0.32622667424755192),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.9526176801567470, 0.0000000000000000),
            Complex::new(0.75700184367497048, 0.16838435233835175),
            Complex::new(1.6131204290533503, 2.1577647464386205),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(3.8280675503299628, 0.0000000000000000),
            Complex::new(1.2465977656252329, -2.0399292751731535),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(6.2689119892061624, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'n',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(2.3395745377104555, 0.0000000000000000),
            Complex::new(-0.23904306353599897, 0.38527767539008539),
            Complex::new(1.5499317619775281, 0.61030106552499741),
            Complex::new(-3.5119502185009782E-002, 0.47329141696789950),
            Complex::new(1.6755206054435083, -0.14669212776134405),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(1.1198417497625819, 0.0000000000000000),
            Complex::new(0.18597724644402175, -0.13914165833399272),
            Complex::new(-0.16907159032896413, 1.2348811617422519),
            Complex::new(-0.46540957116130022, 1.1081177222021112),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(2.1022252342348491, 0.0000000000000000),
            Complex::new(0.96275725625355346, 0.35673571528200110),
            Complex::new(1.4870086981201609, 0.93708248306429232),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(3.6393697204873954, 0.0000000000000000),
            Complex::new(1.1799295830137675, -0.92797911610027772),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(6.9112116413057718, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'c',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.1476878135503865, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.29469241706829941, -0.69361000427875985),
            Complex::new(4.0500669722552383, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.36742658827363606, 0.90779156317481691),
            Complex::new(2.6609646250468799E-002, -1.2644121466149967),
            Complex::new(1.0465961268435413, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.71514447317466534, -5.1637874258017025E-002),
            Complex::new(5.9362659176806609E-002, -0.45332789330975831),
            Complex::new(-4.1181120977291652E-002, -0.22614482992219803),
            Complex::new(0.95666032954611491, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.17741805067471494, -0.88246217293517693),
            Complex::new(-0.27825711791551100, 0.12823037359207640),
            Complex::new(-1.0599872384057019E-002, -0.18665144771536654),
            Complex::new(-0.69455433956435164, -0.23297790106179717),
            Complex::new(1.1760957713458100, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'c',
        5,
        4,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        0.5,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.7791649310888387, 0.0000000000000000),
            Complex::new(0.13157573847275650, 0.47885345587406630),
            Complex::new(0.29747305896223430, -0.28863949408302003),
            Complex::new(1.3513591466938000, -8.8035269367242375E-002),
            Complex::new(2.9902669282636740E-002, 1.7614137224652062),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(3.9027067517037475, 0.0000000000000000),
            Complex::new(2.3726059916404196E-002, 0.68112687449356724),
            Complex::new(1.2616893145646850, -7.9467416710688465E-002),
            Complex::new(0.10353959972822679, -0.91012142154663556),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(0.89698857276543920, 0.0000000000000000),
            Complex::new(-0.24693653355587442, 3.7793466978548740E-002),
            Complex::new(0.11551185854913237, 1.4073337110896953),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(1.1453581593886824, 0.0000000000000000),
            Complex::new(-0.62788615695288619, -0.87897225801107881),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(0.53379611924620063, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'c',
        5,
        4,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        1.0,
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'c',
        5,
        4,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        0.8,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.0103634031171111, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.74285365257939162, -0.36222718301753964),
            Complex::new(-0.23577635639572669, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.91812564310618683, 0.66563769378718263),
            Complex::new(-0.23156926976992587, -0.18186295303498135),
            Complex::new(-0.23937209009188543, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.34854665321926248, -4.3901980577438771E-002),
            Complex::new(-0.99003078028605529, 0.20011306107212690),
            Complex::new(-0.17941431074461800, 0.49459462902835938),
            Complex::new(0.30191653224701476, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-4.5685420121035270E-002, 0.28698311279688937),
            Complex::new(0.40288639668951021, -8.8363827591595445E-003),
            Complex::new(0.86861554486476678, -0.75251933265506210),
            Complex::new(-0.55276308883373559, -9.2660261581245962E-002),
            Complex::new(-1.0276794586729920, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'u',
        'c',
        5,
        4,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'c',
        5,
        4,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        0.8,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.0103634031171111, 0.0000000000000000),
            Complex::new(-0.26098668964187333, -0.34361048256770488),
            Complex::new(1.0638394514298355, 0.99064332530861066),
            Complex::new(1.0179434927991551, -0.22347703313048228),
            Complex::new(0.33171315687467384, 1.4063225002038848),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.23577635639572669, 0.0000000000000000),
            Complex::new(-4.6137382032534202E-003, -0.93325644930089169),
            Complex::new(1.9237226772863067, -0.85247250873554492),
            Complex::new(0.61087475733272356, -1.2510256953690302),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.23937209009188543, 0.0000000000000000),
            Complex::new(-0.32920866503132373, -0.30136218520048530),
            Complex::new(0.20177877249984100, 1.9530916505022589),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(0.30191653224701476, 0.0000000000000000),
            Complex::new(0.10666909376783806, -1.7791202810275593),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.0276794586729920, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::her2k(
        'l',
        'c',
        5,
        4,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        0.0,
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::her2k(
            'x',
            'c',
            5,
            4,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            0.0,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::her2k(
            'l',
            'x',
            5,
            4,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            0.0,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::her2k(
            'l',
            'n',
            5,
            4,
            Complex::new(0.0, 0.0),
            &a,
            4,
            &b,
            6,
            0.0,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::her2k(
            'l',
            'n',
            5,
            4,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            4,
            0.0,
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::her2k(
            'l',
            'n',
            5,
            4,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            0.0,
            &mut vec![],
            4,
        );
    });
    assert!(result.is_err());
}

#[test]
fn herk() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'n', 4, 6, 0.0, &a, 6, 1.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(1.2629542350769043, 0.99216037988662720),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.29472044110298157, -0.83204329013824463),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.29921510815620422, 0.26613736152648926),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(0.37739565968513489, -0.17262350022792816),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'n', 4, 6, 0.0, &a, 6, 0.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('l', 'n', 4, 6, 0.0, &a, 6, 0.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('l', 'n', 4, 6, 0.0, &a, 6, 0.5, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(0.63147711753845215, 0.0000000000000000),
            Complex::new(-0.16311667859554291, -0.21475654840469360),
            Complex::new(0.66489964723587036, 0.61915206909179688),
            Complex::new(0.63621467351913452, -0.13967314362525940),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.14736022055149078, 0.0000000000000000),
            Complex::new(-2.8835863340646029E-003, -0.58328527212142944),
            Complex::new(1.2023266553878784, -0.53279531002044678),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.14960755407810211, 0.0000000000000000),
            Complex::new(-0.20575541257858276, -0.18835136294364929),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(0.18869782984256744, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'n', 4, 6, 0.2, &a, 6, 0.5, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(1.7290593975566546, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.50142463497895062, -0.25479635191838890),
            Complex::new(0.54903737895204929, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.51074128039019118, 0.36215083388446062),
            Complex::new(0.12492495059790593, 4.3510452327288618E-002),
            Complex::new(1.3641416174735665, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-5.4100663269638076E-002, -0.44984149203585322),
            Complex::new(-0.69734669515316827, -0.51962226569284409),
            Complex::new(0.30051980781257026, 0.25928534634610489),
            Complex::new(2.1917644304238264, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'n', 4, 6, 0.2, &a, 6, 0.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(1.0975822800182025, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-3.7141109035194485E-002, -2.8404365905930096E-002),
            Complex::new(0.69639759950354008, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(6.3087238000464368E-002, -5.3872718533294506E-002),
            Complex::new(0.26965574204745274, 0.15717479628042125),
            Complex::new(1.5137491715516687, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.27194231828558352, -0.42240275458382304),
            Complex::new(-7.8577466694763745E-002, -0.64469292699922542),
            Complex::new(0.41265375035703061, -4.9836292190348450E-002),
            Complex::new(2.0030666005812590, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'n', 4, 6, 0.2, &a, 6, 1.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.3605365150951068, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.96570816092270650, -0.48118833793084770),
            Complex::new(0.40167715840055845, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.0845697987808469, 0.77817438630221569),
            Complex::new(-1.9805840851640832E-002, -7.0153891625843956E-002),
            Complex::new(1.2145340633954644, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.16374099174630735, -0.47728022948788340),
            Complex::new(-1.3161159236115731, -0.39455160438646292),
            Complex::new(0.18838586526810999, 0.56840698488255814),
            Complex::new(2.3804622602663938, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('l', 'n', 4, 6, 0.2, &a, 6, 1.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.3605365150951068, 0.0000000000000000),
            Complex::new(-0.36337446622628033, -0.40110873090345711),
            Complex::new(1.3928865324722048, 1.2921768567168883),
            Complex::new(1.0004870287526855, 0.14305646733330429),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(0.40167715840055845, 0.0000000000000000),
            Complex::new(0.26388856937932353, -1.3237453405232802),
            Complex::new(2.3260758440809930, -0.42089769304166819),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.2145340633954644, 0.0000000000000000),
            Complex::new(1.1429251998650788E-003, -0.32686643369695023),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(2.3804622602663938, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'c', 4, 6, 0.2, &a, 6, 0.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.2475633992730493, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.36106021899967000, -1.0814334285577285),
            Complex::new(3.0259301296248560, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(1.0058285921496710, 0.47476237523631842),
            Complex::new(-0.75316556491383857, 0.15292505454474753),
            Complex::new(2.0136910810504953, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.90180653469386363, 0.14218481502237462),
            Complex::new(0.32478903686518640, -0.50868035075148443),
            Complex::new(-1.0421890586849125, 6.2968630915559765E-002),
            Complex::new(1.9197208584549985, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('u', 'c', 4, 6, 0.2, &a, 6, 0.2, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.5001542500523271, 0.0000000000000000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.17534680585482210, -1.1719902243121134),
            Complex::new(2.9669860405259243, 0.0000000000000000),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.77629718137312431, 0.64117179868311402),
            Complex::new(-0.81105788235632004, 0.10745931628600219),
            Complex::new(1.9538480585275240, 0.0000000000000000),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.81466987138904801, 0.13120931987801493),
            Complex::new(7.7281341793672576E-002, -0.45865208548345271),
            Complex::new(-1.0870426363710670, 0.18661728817264961),
            Complex::new(1.9951999915167522, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('l', 'c', 4, 6, 0.2, &a, 6, 0.0, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.2475633992730493, 0.0000000000000000),
            Complex::new(0.36106021899967000, 1.0814334285577285),
            Complex::new(1.0058285921496710, -0.47476237523631842),
            Complex::new(-0.90180653469386363, -0.14218481502237462),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(3.0259301296248560, 0.0000000000000000),
            Complex::new(-0.75316556491383857, -0.15292505454474753),
            Complex::new(0.32478903686518640, 0.50868035075148443),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(2.0136910810504953, 0.0000000000000000),
            Complex::new(-1.0421890586849125, -6.2968630915559765E-002),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(1.9197208584549985, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::herk('l', 'c', 4, 6, 0.2, &a, 6, 0.2, &mut c, 6);
    capproximately!(
        c,
        vec![
            Complex::new(2.5001542500523271, 0.0000000000000000),
            Complex::new(0.29581354658920167, 0.99553080791580228),
            Complex::new(1.2717884550071299, -0.22710154390916576),
            Complex::new(-0.64732066149407486, -0.19805407330499519),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(2.9669860405259243, 0.0000000000000000),
            Complex::new(-0.75431899946465197, -0.38623916686997045),
            Complex::new(0.80571970618676314, 0.29556222356759820),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.9538480585275240, 0.0000000000000000),
            Complex::new(-1.1244912249427435, -0.13830917721568109),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(1.9951999915167522, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::herk('x', 'n', 4, 6, 0.1, &a, 6, 0.3, &mut vec![], 6);
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::herk('u', 'x', 4, 6, 0.1, &a, 6, 0.3, &mut vec![], 6);
    });
    assert!(result.is_err());


    let result = std::panic::catch_unwind(|| {
        complex::herk('u', 'n', 4, 6, 0.1, &a, 3, 0.3, &mut vec![], 6);
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::herk('u', 'n', 5, 6, 0.1, &a, 6, 0.3, &mut vec![], 4);
    });
    assert!(result.is_err());
}

#[test]
fn symm() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'u',
        4,
        5,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'u',
        4,
        5,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.4146414344564082, 1.7579030898107073),
            Complex::new(-1.5399500419037095, 0.5607460908880562),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.7635934611404596, -1.563782051071005),
            Complex::new(-0.7990092489893682, 1.1565369971501793),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.2522234481561323, 2.4413646288945894),
            Complex::new(-0.8919211272845686, -0.7953391172553718),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.1333363608148414, -2.2239002740099374),
            Complex::new(0.8041895097449078, -1.263614384970583),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(0.0, 0.0),
            Complex::new(-1.2845993538721883, -0.8149687088699175),
            Complex::new(0.04672617218835198, 0.24226348085968588),
            Complex::new(-0.23570655643950122, -1.4250983947324998),
            Complex::new(-0.5428882550102544, 0.36594112304921983),
            Complex::new(-0.4333103174567822, 0.2484126488725964),
            Complex::new(-0.6494716467962331, 0.06528818167162072),
            Complex::new(0.726750747385451, 0.01915639166027384),
            Complex::new(1.1519117540872, 0.2573383771555333)
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'u',
        4,
        5,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-0.49608018994331360, 0.63147711753845215),
            Complex::new(0.21475654840469360, -0.16311667859554291),
            Complex::new(-0.61915206909179688, 0.66489964723587036),
            Complex::new(0.13967314362525940, 0.63621467351913452),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.22639198601245880, -0.46428352594375610),
            Complex::new(0.41602164506912231, -0.14736022055149078),
            Complex::new(0.58328527212142944, -2.8835863340646029E-003),
            Complex::new(0.53279531002044678, 1.2023266553878784),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.41602355241775513, -0.57382851839065552),
            Complex::new(0.11366434395313263, -0.14473079144954681),
            Complex::new(-0.13306868076324463, -0.14960755407810211),
            Complex::new(0.18835136294364929, -0.20575541257858276),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(2.7438737452030182E-002, 0.21784165501594543),
            Complex::new(-0.12507066130638123, -0.61876922845840454),
            Complex::new(-0.30912163853645325, -0.11213394254446030),
            Complex::new(8.6311750113964081E-002, 0.18869782984256744),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-0.17936444282531738, -2.8553387150168419E-002),
            Complex::new(5.5227391421794891E-003, 0.25180399417877197),
            Complex::new(0.47032457590103149, 0.54288470745086670),
            Complex::new(5.7912662625312805E-002, -0.34547692537307739),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'u',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-2.2968014924921123, -0.52936348236209740),
            Complex::new(0.35489687384414803, -2.2927378534530440),
            Complex::new(-1.3783587245064326, -2.3059544968549628),
            Complex::new(-0.72898874442339034, 0.59368436499219035),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.10739761644651513, 0.94204795064473434),
            Complex::new(-3.4566256523152337, -1.6187282448880311),
            Complex::new(-1.3483694069194099, 1.8418290113239979),
            Complex::new(0.11753648309305997, 1.3217121569037471),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-8.4138573879255246E-002, -1.8380107319609060),
            Complex::new(9.0552436543457765E-002, 1.7531635283533900),
            Complex::new(1.8860812180571460, 0.37916577798682471),
            Complex::new(-0.32629307536500785, -0.22190535570622069),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.59382620653175278, 1.3518102090396353),
            Complex::new(-0.80675541202414347, 0.13797920961329080),
            Complex::new(-0.55234254898652901, 4.0660390058228246E-002),
            Complex::new(1.1469169235729075, 0.93424402758150493),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-2.0535297393515086, -0.90738799511552626),
            Complex::new(0.66440011969325696, 0.18560436104215738),
            Complex::new(0.27518635188501162, -0.26361336171321681),
            Complex::new(-1.1191619149239813, -0.20332913599157931),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'u',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(-0.45, 0.2),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-3.0635629621553253, -0.72324479070432846),
            Complex::new(0.58760450133305819, -2.1647036374194832),
            Complex::new(-2.2244292224934261, -2.5972314814183854),
            Complex::new(-1.2457126771394509, 0.97387606412464534),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.61580957448089868, 0.96008731951349380),
            Complex::new(-3.1575927968249022, -1.3032528633434817),
            Complex::new(-1.1124600669622788, 2.3656323077758663),
            Complex::new(-0.75143935090644309, 2.2821585925408958),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.26589765554440115, -2.4419633299946581),
            Complex::new(0.26627588365614430, 1.7975691177587587),
            Complex::new(1.9675005400620669, 0.19956094594953780),
            Complex::new(-6.5772662649753344E-002, -0.13469129980541369),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.40874421735551142, 1.4636417353970876),
            Complex::new(-0.29989138643221913, -0.22209207765204922),
            Complex::new(-0.57507066062708612, -0.28240265494069994),
            Complex::new(1.0116135817735474, 1.0874037336879938),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-2.0995774697963450, -1.0802373444121891),
            Complex::new(0.43998562662562701, 0.29129642531082411),
            Complex::new(-2.5280038713622777E-002, 0.37683263160049152),
            Complex::new(-0.78506762492971194, -0.28939851321797716),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'l',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-3.8333497901901694, 2.9206721297073388),
            Complex::new(4.0337134933481513, 2.3506737863282625),
            Complex::new(-2.5892107980300336, -0.54660776934073463),
            Complex::new(1.0875583705347331, 0.57236987683953822),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(4.3877885507785717, 1.6351682799134268),
            Complex::new(3.8172564743961530, 1.4163678797318400),
            Complex::new(0.67416915126009014, -2.4820886098673176),
            Complex::new(1.3474196179958526, -2.5611815252913859),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.51064199014805089, -2.9616433883062907),
            Complex::new(-0.41777799829000256, -0.27874915275343692),
            Complex::new(-0.69482630794178268, -2.1840826741234074),
            Complex::new(-1.2911708889627647, -1.5158614406578568),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.72898874442339034, 0.59368436499219035),
            Complex::new(0.18860989731474426, 1.5280920237001510),
            Complex::new(-1.1486684282513933, 0.82139850865391395),
            Complex::new(-1.4892507275872222, -1.1002656652229008),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-3.8367821023613968E-002, 0.94462773309408787),
            Complex::new(0.47468822156721668, -2.5610852567248483),
            Complex::new(-0.63176315928510762, -0.15637152773359697),
            Complex::new(5.8696244842979695E-002, 0.10846525402097236),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'l',
        'l',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.2, -0.3),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-3.2831108136174301, 2.7402179230628736),
            Complex::new(3.8396128867746722, 2.3626411767326667),
            Complex::new(-1.9517596789557610, -0.69788674220754709),
            Complex::new(1.2582403542292990, 0.13477179927689709),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(4.0662399406286429, 1.8231816107946774),
            Complex::new(3.5086993883370194, 1.3383753550687447),
            Complex::new(0.32304453952981449, -2.7136725703233515),
            Complex::new(1.5086730886023312, -3.4956956743737004),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.49055925955517010, -2.4509368401439637),
            Complex::new(-0.54386892481433269, -0.23737641269180321),
            Complex::new(-0.67482811883420268, -2.0410906650111751),
            Complex::new(-1.4864838774774316, -1.4677487345052371),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.65831532424398331, 0.45200387164451361),
            Complex::new(1.6144602008976106E-002, 1.9493818407958337),
            Complex::new(-1.0080490154456416, 1.0123275341111615),
            Complex::new(-1.4655586466516795, -1.2480090681873917),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(5.7829493917699204E-002, 1.0335055442641772),
            Complex::new(0.57209617712261418, -2.7143767549253766),
            Complex::new(-0.69680402982294654, -0.67023219831126257),
            Complex::new(-0.11424212632138736, 0.29258635208631906),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'r',
        'u',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-0.68789145940302987, 1.8329511695677019),
            Complex::new(-0.35809168245188361, -1.0636083744696306E-002),
            Complex::new(-3.2593764899338589, 1.0372370209678747),
            Complex::new(-0.41238007275876321, 0.26500281030402489),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-4.0166250214634658E-003, -0.72614159015953206),
            Complex::new(-0.17916625616086776, 1.1137145475848402),
            Complex::new(2.0080915542539346, -1.2131710860970963),
            Complex::new(0.50624436468776812, -3.2230829658515958),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.69495237809229937, -1.3354370915785085),
            Complex::new(0.91614440470384206, 0.99016837101678445),
            Complex::new(1.3961115316961736, -2.7623140474023393),
            Complex::new(-2.1084023282426259, -1.8357926337335364),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.80302837210733169, 1.3683664988160076),
            Complex::new(-0.76497292858919685, 5.4819963486339163E-002),
            Complex::new(-1.9658998675312542, 0.50146731557823421),
            Complex::new(-1.5244983117274997, -0.69705230310299404),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.6489611913313786, -0.69767481020573352),
            Complex::new(0.66985596056305741, -0.40963884907530390),
            Complex::new(-0.75833799382131772, -1.9739152075580129),
            Complex::new(-0.35217871501270248, 0.88540810150424742),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'r',
        'u',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.1, 0.9),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-1.4545403522564087, 3.0688259904928370),
            Complex::new(-4.1532417690594847E-003, -0.34719740775962737),
            Complex::new(-4.2408702533468920, 2.3578867699511319),
            Complex::new(-3.3725484293536417E-002, 1.3822545631600767),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(0.31063223243332727, -1.6071303125967220),
            Complex::new(0.54020064057662853, 0.76526182736517412),
            Complex::new(3.0574282989838917, -1.3350185975235238),
            Complex::new(1.7057412319797005, -1.1654541070767599),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.5585604579949832, -2.2851236855960146),
            Complex::new(1.0917940596783018, 0.70692008417952956),
            Complex::new(1.1266664014060568, -3.0049939010598545),
            Complex::new(-1.8105209670542655, -2.2438226397138634),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.89598642986501287, 1.7549937198850301),
            Complex::new(-1.1138539605126059, -1.0339504855995572),
            Complex::new(-2.5447455909998791, 0.36145055297371376),
            Complex::new(-1.3313975991071523, -0.37465856866420832),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.9775278573793162, -0.71319801661489390),
            Complex::new(0.73015769034182454, 4.2503780594640550E-002),
            Complex::new(0.19682316348181128, -1.0907876766150957),
            Complex::new(-0.31703131115284733, 0.25196711960867590),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::symm(
        'r',
        'l',
        4,
        5,
        Complex::new(0.2, 0.8),
        &a,
        6,
        &b,
        6,
        Complex::new(0.1, 0.9),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-3.2329928277905804, 0.19275090419455865),
            Complex::new(-0.30416433267163456, -1.5550639420612633),
            Complex::new(-5.2325825375472270, 3.4164800029642555),
            Complex::new(2.4597600096686323, 1.3707797248053202),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.11913555484672778, 1.2631038170995079),
            Complex::new(-1.7255743084372139, -2.5329001340582855),
            Complex::new(1.6087635175112540, -1.1806197375047380),
            Complex::new(1.8770284039924505, -0.28151548354724260),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-3.6510582073017090, -1.1369642620765816),
            Complex::new(-0.58113546142178552, -6.5411612935301233E-002),
            Complex::new(-4.2247059440545929, 2.2662095980694170),
            Complex::new(3.1795104002170413, -0.36973704442330557),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.51045670906194318, 1.3021703259561368),
            Complex::new(1.3578335576483098, -3.6219231345450065),
            Complex::new(2.3247922324626504, -1.6484619774679632),
            Complex::new(4.6965465984792782, 4.2780600065100467),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-1.0641815567849253, -3.7897173043656944),
            Complex::new(-0.63688702963644950, 4.0720985901679052E-002),
            Complex::new(-1.8124927384357186, -2.6712802397442732),
            Complex::new(3.4904477306612107, 0.59713014768198525),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::symm(
            'l',
            'x',
            4,
            5,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.3, -0.7),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::symm(
            'x',
            'u',
            4,
            5,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.3, -0.7),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::symm(
            'l',
            'u',
            4,
            5,
            Complex::new(0.2, 0.8),
            &a,
            3,
            &b,
            6,
            Complex::new(0.3, 0.7),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::symm(
            'l',
            'u',
            4,
            5,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            3,
            Complex::new(0.3, -0.7),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::symm(
            'l',
            'u',
            4,
            5,
            Complex::new(0.2, 0.8),
            &a,
            6,
            &b,
            6,
            Complex::new(0.3, -0.7),
            &mut vec![],
            3,
        );
    });
    assert!(result.is_err());
}

#[test]
fn syr2k() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let b = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'u',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'u',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(0.5, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.13539692759513855, 1.1275573074817657),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.23789153993129730, -0.69067551195621490),
            Complex::new(0.26866142451763153, -0.56338186562061310),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-0.98985207080841064, -0.15780496597290039),
            Complex::new(-3.1066447496414185E-002, -0.25839513540267944),
            Complex::new(-0.28267623484134674, -1.6538873314857483E-002),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.24528039246797562, 0.19040291756391525),
            Complex::new(-0.74383988976478577, -0.49369856715202332),
            Complex::new(-0.42125558108091354, 0.19698769599199295),
            Complex::new(0.27500957995653152, 0.10238607972860336),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'l',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let b = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'u',
        'n',
        4,
        6,
        Complex::new(0.2, -0.6),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-0.83586151233225592, 0.56394888106102226),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(2.5730431305934260, 0.16767797999470757),
            Complex::new(0.34240360482570337, -1.5283522018086906),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(2.2851128239359300, 0.40582968598509878),
            Complex::new(-2.6511185560568755, -0.99018119069383548),
            Complex::new(0.32721593572802232, 1.4677243405786666),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(9.7309823990200384E-002, 1.9625297367448562),
            Complex::new(-3.3629068550787586, 2.2674848482313434),
            Complex::new(-1.0090793322692606, -0.91308506594236150),
            Complex::new(-3.8129725167517088, -10.883702715857607),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'u',
        'n',
        4,
        6,
        Complex::new(0.2, -0.6),
        &a,
        6,
        &b,
        6,
        Complex::new(-0.4, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-1.3410432138908113, 0.16708472319263468),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(2.9444699568831219, 0.34879157150347739),
            Complex::new(0.46029178302356649, -1.1955348807940278),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(2.7441756454890234, 7.3010839091507518E-002),
            Complex::new(-2.5353339211719126, -0.89924971417634481),
            Complex::new(0.44690198077396509, 1.3612693943817686),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-7.6963502619430857E-002, 1.9844807270335758),
            Complex::new(-2.8678914649357310, 2.1674283176952800),
            Complex::new(-0.91937217689695161, -1.1603823804565412),
            Complex::new(-3.9639307828752157, -10.814653314737519),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'l',
        'n',
        4,
        6,
        Complex::new(0.2, -0.6),
        &a,
        6,
        &b,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.42709272274464838, 1.5561092609476495),
            Complex::new(2.2468097734023402, -0.26183511681467952),
            Complex::new(3.6149121184076707, 1.6441338241686925),
            Complex::new(1.3697391710284696, 1.6831834494943383),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(4.7683163722721744E-002, -2.3603954919469348),
            Complex::new(-2.6568857287250052, -2.1567517349366945),
            Complex::new(-0.95825354430300269, 1.2018942281904494),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(2.8000827571818113E-002, 1.7338617021051559),
            Complex::new(-1.4205901574264264, -1.2897877918296592),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(-3.4355768570665752, -11.056326216085536),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'u',
        't',
        4,
        6,
        Complex::new(0.2, -0.6),
        &a,
        6,
        &b,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.4468631471167859, 3.3391748650861475E-002),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-2.6337058928758674, -10.991585420020956),
            Complex::new(-9.3090745515998492, -4.1381001156460187),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(0.90654109547112283, 5.2716677184376106),
            Complex::new(3.5716115479891912, -6.6796892571654096),
            Complex::new(-0.78481224134314043, 6.4458952971264321),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(4.1797654156603841, -3.0256672163596514),
            Complex::new(-4.6784829266891925E-002, 1.2743966815221131),
            Complex::new(2.0382512309592462, -3.8321466782020641),
            Complex::new(-6.2165594209786832, 3.8498345412180353),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syr2k(
        'l',
        't',
        4,
        6,
        Complex::new(0.2, -0.6),
        &a,
        6,
        &b,
        6,
        Complex::new(0.5, 0.5),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(3.5822600747119244, 1.1609490561326270),
            Complex::new(-2.5820660230667167, -11.369458647021192),
            Complex::new(0.95228867361519631, 6.5557194347652779),
            Complex::new(4.9556532328047780, -2.5291256864657763),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-9.0404131270822177, -4.7014819812666317),
            Complex::new(4.1520132337765556, -7.2658581156209037),
            Complex::new(1.6883371361414334, 1.9439280268895445),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-1.0674884761844872, 6.4293564238115746),
            Complex::new(2.0208471813243127, -4.2262534537242962),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(-5.9415498410221517, 3.9522206209466386),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::syr2k(
            'x',
            'n',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            Complex::new(1.0, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syr2k(
            'u',
            'x',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            Complex::new(1.0, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syr2k(
            'u',
            't',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            3,
            &b,
            6,
            Complex::new(1.0, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syr2k(
            'u',
            't',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            3,
            Complex::new(1.0, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syr2k(
            'u',
            't',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            &b,
            6,
            Complex::new(1.0, 0.0),
            &mut vec![],
            3,
        );
    });
    assert!(result.is_err());
}

#[test]
fn syrk() {
    let a = fixtures::complex::matrix_mxn(6, 6);
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'u',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(c, a);

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'u',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        Complex::new(0.2, -0.3),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.55023897657273935, -0.18045420664446521),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.32154861014992875, 0.18801333088125061),
            Complex::new(-0.30855708605913401, -7.7992524663095253E-002),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(2.0082730592880793E-002, 0.51070654816232697),
            Complex::new(-0.12609092652433018, 4.1372740061633717E-002),
            Complex::new(1.9998189107580000E-002, 0.14299200911223231),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(7.0673420179407032E-002, -0.14168049334767674),
            Complex::new(-0.17246529530576815, 0.42128981709568247),
            Complex::new(0.14061941280575163, 0.19092902545724755),
            Complex::new(2.3692080935542759E-002, -0.14774340296449107),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'l',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        Complex::new(0.2, -0.3),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.55023897657273935, -0.18045420664446521),
            Complex::new(-0.19410060657347961, 1.1967390404404199E-002),
            Complex::new(0.63745111907427265, -0.15127897286681247),
            Complex::new(0.17068198369456589, -0.43759807756264113),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(-0.30855708605913401, -7.7992524663095253E-002),
            Complex::new(-0.35112461173027559, -0.23158396045603410),
            Complex::new(0.16125347060647854, -0.93451414908231456),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(1.9998189107580000E-002, 0.14299200911223231),
            Complex::new(-0.19531298851466694, 4.8112706152619644E-002),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(2.3692080935542759E-002, -0.14774340296449107),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'l',
        'n',
        4,
        6,
        Complex::new(0.0, 0.0),
        &a,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(0.0000000000000000, 0.0000000000000000),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut mat = fixtures::complex::matrix_mxn(6, 6);
    mat[0] = Complex { re: 0.0, im: 0.0 };
    let a = mat.clone();
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'u',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        Complex::new(0.2, -0.3),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.81258069861096716, -0.78317760511780088),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-1.7954095980537197, 0.99635550854288524),
            Complex::new(3.8044187016830988E-002, 0.88244242913566751),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.3787696856957568, 1.0872896859381984),
            Complex::new(1.6785876585678317, -0.34191907766352081),
            Complex::new(-0.67367407407939550, -0.54973079038592654),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-0.66973236653820745, -1.1870133923122208),
            Complex::new(0.88351377256481423, -2.0028441866578488),
            Complex::new(1.0151927979751547, 0.33994804861654909),
            Complex::new(5.9301227490237896, 4.5037526499313945),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );
    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'l',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(0.26234172203822781, -0.60272339847333567),
            Complex::new(-1.4738609879037909, 0.80834217766163474),
            Complex::new(-1.3988524162886375, 0.57658313777587145),
            Complex::new(-0.74040578671761470, -1.0453328989645438),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(0.34660127307596467, 0.96043495379876276),
            Complex::new(1.8046785850921616, -0.38329181772515458),
            Complex::new(1.0559790678705823, -2.4241340037535308),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.69367226318697550, -0.69272279949815885),
            Complex::new(0.87457338516940331, 0.14901902315930199),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(5.9064306680882463, 4.6514960528958849),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'l',
        'n',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        Complex::new(1.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(1.5252959571151317, 0.38943698141329164),
            Complex::new(-1.8000943450948768, 0.37882908085224742),
            Complex::new(-6.9053121816896990E-002, 1.8148872759594652),
            Complex::new(0.53202356032065434, -1.3246791862150626),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(5.1880831972983432E-002, 0.12839166366051821),
            Complex::new(1.7989114124240324, -1.5498623619680132),
            Complex::new(3.4606323786463382, -3.4897246237944244),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-0.99288737134317973, -0.42658543797166953),
            Complex::new(0.46306256001223778, -0.22768370272799654),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(6.2838263277733812, 4.4788725526679567),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'u',
        't',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        Complex::new(-0.3, 0.7),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-2.9808603488303271, 1.7744564226713000),
            Complex::new(-0.32623335719108582, -0.42951309680938721),
            Complex::new(1.3297992944717407, 1.2383041381835938),
            Complex::new(1.2724293470382690, -0.27934628725051880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(5.8911118832052018, 4.6094131151925977),
            Complex::new(7.2391723333828963, -0.93891226686099127),
            Complex::new(-5.7671726681292057E-003, -1.1665705442428589),
            Complex::new(2.4046533107757568, -1.0655906200408936),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-2.5818170710891248, -3.6351018749077326),
            Complex::new(0.61947340072428903, 4.7894685304655704),
            Complex::new(-1.9209481658981211, -4.1092184098735594),
            Complex::new(-0.41151082515716553, -0.37670272588729858),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(-1.3321782148965793, 3.4484763403003704),
            Complex::new(-0.22414453871646978, -1.6586121570342662),
            Complex::new(-0.14527678397845112, 2.4786080350511233),
            Complex::new(2.0792833234907668, -3.9772406742098481),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let mut c = fixtures::complex::matrix_mxn(6, 6);
    complex::syrk(
        'l',
        't',
        4,
        6,
        Complex::new(0.2, 0.8),
        &a,
        6,
        Complex::new(0.0, 0.0),
        &mut c,
        6,
    );
    capproximately!(
        c,
        vec![
            Complex::new(-1.9074618091585025, 1.1880365989665163),
            Complex::new(5.2955929815497296, 5.1235748434393935),
            Complex::new(-2.3436812323385734, -2.5821278214725254),
            Complex::new(-1.2398874484719140, 3.1270347853463880),
            Complex::new(0.41464143991470337, 1.7579030990600586),
            Complex::new(-1.5399500131607056, 0.56074607372283936),
            Complex::new(-0.92856705188751221, -0.45278397202491760),
            Complex::new(6.5683259043606181, -0.98222095856244795),
            Complex::new(0.37350484357949343, 4.9238930259624363),
            Complex::new(-0.42030716769710375, -0.71729285217936234),
            Complex::new(0.76359343528747559, -1.5637820959091187),
            Complex::new(-0.79900926351547241, 1.1565370559692383),
            Complex::new(-1.1476570367813110, 0.83204710483551025),
            Complex::new(-0.28946158289909363, -0.22732868790626526),
            Complex::new(-1.8244165520159665, -3.8199266261005871),
            Complex::new(0.22021313440239154, 2.8210685424317923),
            Complex::new(0.25222346186637878, 2.4413645267486572),
            Complex::new(-0.89192110300064087, -0.79533910751342773),
            Complex::new(0.43568331003189087, -5.4877474904060364E-002),
            Complex::new(-1.2375384569168091, 0.25014132261276245),
            Complex::new(-0.22426788508892059, 0.61824327707290649),
            Complex::new(2.0716655777934969, -4.2932046836167466),
            Complex::new(0.13333636522293091, -2.2239003181457520),
            Complex::new(0.80418950319290161, -1.2636144161224365),
            Complex::new(-5.7106774300336838E-002, 0.35872888565063477),
            Complex::new(0.50360798835754395, -1.1045478284358978E-002),
            Complex::new(1.0857694149017334, -0.94064915180206299),
            Complex::new(-0.69095385074615479, -0.11582532525062561),
            Complex::new(-1.2845993041992188, -0.81496870517730713),
            Complex::new(4.6726170927286148E-002, 0.24226348102092743),
            Complex::new(-0.23570655286312103, -1.4250984191894531),
            Complex::new(-0.54288828372955322, 0.36594113707542419),
            Complex::new(-0.43331032991409302, 0.24841265380382538),
            Complex::new(-0.64947164058685303, 6.5288178622722626E-002),
            Complex::new(0.72675073146820068, 1.9156390801072121E-002),
            Complex::new(1.1519117355346680, 0.25733837485313416),
        ]
    );

    let result = std::panic::catch_unwind(|| {
        complex::syrk(
            'x',
            'n',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            Complex::new(1.0, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syrk(
            'u',
            'x',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            Complex::new(1.0, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syrk(
            'u',
            't',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            3,
            Complex::new(1.0, 0.0),
            &mut vec![],
            6,
        );
    });
    assert!(result.is_err());

    let result = std::panic::catch_unwind(|| {
        complex::syrk(
            'u',
            't',
            4,
            6,
            Complex::new(0.0, 0.0),
            &a,
            6,
            Complex::new(1.0, 0.0),
            &mut vec![],
            3,
        );
    });
    assert!(result.is_err());
}
